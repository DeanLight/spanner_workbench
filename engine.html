<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.554">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Spannerlib - Engine</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="styles.css">
<meta property="og:title" content="Spannerlib - Engine">
<meta property="og:description" content="work bench">
<meta property="og:site_name" content="Spannerlib">
<meta name="twitter:title" content="Spannerlib - Engine">
<meta name="twitter:description" content="work bench">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Spannerlib</span>
    </a>
  </div>
        <div class="quarto-navbar-tools tools-end">
</div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">src</li><li class="breadcrumb-item"><a href="./engine.html">Engine</a></li><li class="breadcrumb-item"><a href="./engine.html">Engine</a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome to Spannerlib</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Tutorials</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stdlib.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Standard library ie functions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./advanced_usage.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Advanced Usage</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./building_your_optimization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Building your own optimization</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./extended_version.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Advanced IE functions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./covid-nlp/covid_pipeline.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Covid-19 NLP Pipeline</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">src</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">
 <span class="menu-text">Generic</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./general_utils.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">General Utils</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./primitive_types.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Primitive Types</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false">
 <span class="menu-text">Grammar &amp; Parsing</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./expected_grammar.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Expected Grammar</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./symbol_table.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Symbol Table</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lark_passes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lark Passes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./passes_utils.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Passes Utils</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./optimizations_passes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Optimizations Passes</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
 <span class="menu-text">Engine</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./engine.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Engine</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./execution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Execution</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="false">
 <span class="menu-text">Graphs</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ast_node_types.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Ast Nodes Types</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ie_function.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">IE Function</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./graphs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Graphs</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./adding_inference_rules_to_term_graph.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Adding inference rules to term graph</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="false">
 <span class="menu-text">User-Interface</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./session.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Session</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#data-storage" id="toc-data-storage" class="nav-link active" data-scroll-target="#data-storage">Data Storage</a>
  <ul class="collapse">
  <li><a href="#where-is-all-the-data-about-the-relations-stored" id="toc-where-is-all-the-data-about-the-relations-stored" class="nav-link" data-scroll-target="#where-is-all-the-data-about-the-relations-stored">Where is all the data about the relations stored?</a></li>
  </ul></li>
  <li><a href="#database-table-structure" id="toc-database-table-structure" class="nav-link" data-scroll-target="#database-table-structure">Database Table Structure</a>
  <ul class="collapse">
  <li><a href="#what-specific-data-is-stored-in-the-db-tables-and-what-is-the-structure-of-these-tables" id="toc-what-specific-data-is-stored-in-the-db-tables-and-what-is-the-structure-of-these-tables" class="nav-link" data-scroll-target="#what-specific-data-is-stored-in-the-db-tables-and-what-is-the-structure-of-these-tables">What specific data is stored in the db tables, and what is the structure of these tables?</a></li>
  </ul></li>
  <li><a href="#rules-and-queries" id="toc-rules-and-queries" class="nav-link" data-scroll-target="#rules-and-queries">Rules and Queries</a>
  <ul class="collapse">
  <li><a href="#how-do-rules-and-queries-work" id="toc-how-do-rules-and-queries-work" class="nav-link" data-scroll-target="#how-do-rules-and-queries-work">How Do Rules and Queries Work?</a></li>
  </ul></li>
  <li><a href="#queries" id="toc-queries" class="nav-link" data-scroll-target="#queries">Queries</a>
  <ul class="collapse">
  <li><a href="#query-decomposition-and-rule-breakdown" id="toc-query-decomposition-and-rule-breakdown" class="nav-link" data-scroll-target="#query-decomposition-and-rule-breakdown">Query Decomposition and Rule Breakdown</a></li>
  <li><a href="#spannerlogenginebase" id="toc-spannerlogenginebase" class="nav-link" data-scroll-target="#spannerlogenginebase">spannerlogEngineBase</a></li>
  <li><a href="#spannerlogenginebase.declare_relation_table" id="toc-spannerlogenginebase.declare_relation_table" class="nav-link" data-scroll-target="#spannerlogenginebase.declare_relation_table">spannerlogEngineBase.declare_relation_table</a></li>
  <li><a href="#spannerlogenginebase.add_fact" id="toc-spannerlogenginebase.add_fact" class="nav-link" data-scroll-target="#spannerlogenginebase.add_fact">spannerlogEngineBase.add_fact</a></li>
  <li><a href="#spannerlogenginebase.remove_fact" id="toc-spannerlogenginebase.remove_fact" class="nav-link" data-scroll-target="#spannerlogenginebase.remove_fact">spannerlogEngineBase.remove_fact</a></li>
  <li><a href="#spannerlogenginebase.query" id="toc-spannerlogenginebase.query" class="nav-link" data-scroll-target="#spannerlogenginebase.query">spannerlogEngineBase.query</a></li>
  <li><a href="#spannerlogenginebase.operator_join" id="toc-spannerlogenginebase.operator_join" class="nav-link" data-scroll-target="#spannerlogenginebase.operator_join">spannerlogEngineBase.operator_join</a></li>
  <li><a href="#spannerlogenginebase.operator_project" id="toc-spannerlogenginebase.operator_project" class="nav-link" data-scroll-target="#spannerlogenginebase.operator_project">spannerlogEngineBase.operator_project</a></li>
  <li><a href="#spannerlogenginebase.operator_union" id="toc-spannerlogenginebase.operator_union" class="nav-link" data-scroll-target="#spannerlogenginebase.operator_union">spannerlogEngineBase.operator_union</a></li>
  <li><a href="#spannerlogenginebase.operator_copy" id="toc-spannerlogenginebase.operator_copy" class="nav-link" data-scroll-target="#spannerlogenginebase.operator_copy">spannerlogEngineBase.operator_copy</a></li>
  <li><a href="#sqliteengine" id="toc-sqliteengine" class="nav-link" data-scroll-target="#sqliteengine">SqliteEngine</a></li>
  <li><a href="#sqliteengine.is_table_exists" id="toc-sqliteengine.is_table_exists" class="nav-link" data-scroll-target="#sqliteengine.is_table_exists">SqliteEngine.is_table_exists</a></li>
  <li><a href="#sqliteengine.remove_table" id="toc-sqliteengine.remove_table" class="nav-link" data-scroll-target="#sqliteengine.remove_table">SqliteEngine.remove_table</a></li>
  <li><a href="#sqliteengine.remove_tables" id="toc-sqliteengine.remove_tables" class="nav-link" data-scroll-target="#sqliteengine.remove_tables">SqliteEngine.remove_tables</a></li>
  <li><a href="#operator_copy" id="toc-operator_copy" class="nav-link" data-scroll-target="#operator_copy">operator_copy</a></li>
  <li><a href="#sqliteengine.compute_ie_relation" id="toc-sqliteengine.compute_ie_relation" class="nav-link" data-scroll-target="#sqliteengine.compute_ie_relation">SqliteEngine.compute_ie_relation</a></li>
  <li><a href="#sqliteengine.add_fact" id="toc-sqliteengine.add_fact" class="nav-link" data-scroll-target="#sqliteengine.add_fact">SqliteEngine.add_fact</a></li>
  <li><a href="#sqliteengine.remove_fact" id="toc-sqliteengine.remove_fact" class="nav-link" data-scroll-target="#sqliteengine.remove_fact">SqliteEngine.remove_fact</a></li>
  <li><a href="#sqliteengine.query" id="toc-sqliteengine.query" class="nav-link" data-scroll-target="#sqliteengine.query">SqliteEngine.query</a></li>
  <li><a href="#sqliteengine.declare_relation_table" id="toc-sqliteengine.declare_relation_table" class="nav-link" data-scroll-target="#sqliteengine.declare_relation_table">SqliteEngine.declare_relation_table</a></li>
  <li><a href="#operator_select" id="toc-operator_select" class="nav-link" data-scroll-target="#operator_select">operator_select</a></li>
  <li><a href="#sqliteengine.operator_join" id="toc-sqliteengine.operator_join" class="nav-link" data-scroll-target="#sqliteengine.operator_join">SqliteEngine.operator_join</a></li>
  <li><a href="#operator_project" id="toc-operator_project" class="nav-link" data-scroll-target="#operator_project">operator_project</a></li>
  <li><a href="#sqliteengine.operator_union" id="toc-sqliteengine.operator_union" class="nav-link" data-scroll-target="#sqliteengine.operator_union">SqliteEngine.operator_union</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/DeanLight/spannerlib/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">src</li><li class="breadcrumb-item"><a href="./engine.html">Engine</a></li><li class="breadcrumb-item"><a href="./engine.html">Engine</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Engine</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->
<p>Here is an overview of the engine module, explaining where data is stored, the structure of database tables, and how rules and queries operate within the system.</p>
<hr>
<section id="table-of-contents" class="level4">
<h4 class="anchored" data-anchor-id="table-of-contents">Table of Contents</h4>
<ol type="1">
<li><a href="#data-storage">Data Storage</a></li>
<li><a href="#database-table-structure">Database Table Structure</a></li>
<li><a href="#rules-and-queries">Rules and Queries</a></li>
</ol>
<hr>
</section>
<section id="data-storage" class="level2">
<h2 class="anchored" data-anchor-id="data-storage">Data Storage</h2>
<section id="where-is-all-the-data-about-the-relations-stored" class="level3">
<h3 class="anchored" data-anchor-id="where-is-all-the-data-about-the-relations-stored">Where is all the data about the relations stored?</h3>
<p>Data about relations is stored in a SQLite3 database.</p>
<blockquote class="blockquote">
<p><strong>SQLite3</strong>: A module in Python’s standard library that offers a lightweight and self-contained relational database management system. It enables creating, connecting to, and manipulating SQLite databases using Python.</p>
</blockquote>
<hr>
</section>
</section>
<section id="database-table-structure" class="level2">
<h2 class="anchored" data-anchor-id="database-table-structure">Database Table Structure</h2>
<section id="what-specific-data-is-stored-in-the-db-tables-and-what-is-the-structure-of-these-tables" class="level3">
<h3 class="anchored" data-anchor-id="what-specific-data-is-stored-in-the-db-tables-and-what-is-the-structure-of-these-tables">What specific data is stored in the db tables, and what is the structure of these tables?</h3>
<p>Whenever a relation is defined, a corresponding table is created in the database. <br> The table has the same name as the relation, and its columns correspond to the variables in the relation—i.e., <code>len(term_list)</code>. the names of columns in the database don’t have an informative name and there is no need because from Python’s perspective it doesn’t understand what the relation or its values mean, it just sorts information in the way they were provided, for example brothers(“Jack”,“Michael”) from Python’s perspective it just sees that “Jack” is the first term so it puts it in the col0 and “Michael” is the second so it gets added to col1.</p>
<section id="example" class="level4">
<h4 class="anchored" data-anchor-id="example">Example</h4>
<p>For example, if we define a new relation <code>brothers(str, str)</code>:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode prolog code-with-copy"><code class="sourceCode prolog"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">%%spannerlog</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>new brothers(str<span class="kw">,</span> str)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The engine will create for us a new table for relation <code>brothers</code> with two columns called col0 and col1.</p>
</section>
</section>
</section>
<section id="rules-and-queries" class="level2">
<h2 class="anchored" data-anchor-id="rules-and-queries">Rules and Queries</h2>
<section id="how-do-rules-and-queries-work" class="level3">
<h3 class="anchored" data-anchor-id="how-do-rules-and-queries-work">How Do Rules and Queries Work?</h3>
<p>When a new rule is added to the system, an empty table is created in the database. <br> This table remains empty initially because multiple rules can share the same rule head. <br> During the querying process, the engine iterates through the list of rules, and the query result is a logical OR of these rules.</p>
<section id="example-1" class="level4">
<h4 class="anchored" data-anchor-id="example-1">Example</h4>
<p>For instance, if we define the rules:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode prolog code-with-copy"><code class="sourceCode prolog"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="dt">A</span>(<span class="dt">X</span><span class="kw">,</span><span class="dt">Y</span>) &lt;- <span class="dt">B</span>(<span class="dt">X</span><span class="kw">,</span><span class="dt">Y</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="dt">A</span>(<span class="dt">X</span><span class="kw">,</span><span class="dt">Y</span>) &lt;- <span class="dt">C</span>(<span class="dt">X</span><span class="kw">,</span><span class="dt">Y</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>result would include all tuples that satisfy either <code>B(X, Y)</code> OR <code>C(X, Y)</code>.</p>
<hr>
</section>
</section>
</section>
<section id="queries" class="level2">
<h2 class="anchored" data-anchor-id="queries">Queries</h2>
<section id="query-decomposition-and-rule-breakdown" class="level3">
<h3 class="anchored" data-anchor-id="query-decomposition-and-rule-breakdown">Query Decomposition and Rule Breakdown</h3>
<p>To understand querying in-depth, it’s beneficial to break down a rule into its constituent parts.</p>
<section id="example-grandparent-rule" class="level4">
<h4 class="anchored" data-anchor-id="example-grandparent-rule">Example: Grandparent Rule</h4>
<p>For example, let’s consider the rule:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode prolog code-with-copy"><code class="sourceCode prolog"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>grandparent(<span class="dt">X</span><span class="kw">,</span> <span class="dt">Z</span>) &lt;- parent(<span class="dt">X</span><span class="kw">,</span> <span class="dt">Y</span>)<span class="kw">,</span> parent(<span class="dt">Y</span><span class="kw">,</span> <span class="dt">Z</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><em>the rule head</em>: grandparent(X,Z) <br> <em>the rule body</em>: relations: [parent(X,Y), parent(Y,Z)]</p>
<p>There are 4 operators in the engine that get called when breaking that rule, we will break down each one of them below.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Each operator yields a relation that is added to the database temporarily. (deleted when we’re done querying).</p>
</div>
</div>
<hr>
<p><a href="https://github.com/DeanLight/spannerlib/blob/master/spannerlib/engine.py#L54" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
</section>
<section id="spannerlogenginebase" class="level3">
<h3 class="anchored" data-anchor-id="spannerlogenginebase">spannerlogEngineBase</h3>
<blockquote class="blockquote">
<pre><code> spannerlogEngineBase ()</code></pre>
</blockquote>
<p><em>An abstraction for a spannerlog execution engine, used by <code>GenericExecution</code>. it includes relational algebra operators like join and project, database modification operators like <a href="https://DeanLight.github.io/spannerlib/engine.html#add_fact"><code>add_fact</code></a> (insert) and <a href="https://DeanLight.github.io/spannerlib/engine.html#remove_fact"><code>remove_fact</code></a> (delete), and spannerlog-specific operators like <a href="https://DeanLight.github.io/spannerlib/engine.html#compute_ie_relation"><code>compute_ie_relation</code></a>.</em></p>
<hr>
<p><a href="https://github.com/DeanLight/spannerlib/blob/master/spannerlib/engine.py#L65" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="spannerlogenginebase.declare_relation_table" class="level3">
<h3 class="anchored" data-anchor-id="spannerlogenginebase.declare_relation_table">spannerlogEngineBase.declare_relation_table</h3>
<blockquote class="blockquote">
<pre><code> spannerlogEngineBase.declare_relation_table
                                              (relation_decl:spannerlib.as
                                              t_node_types.RelationDeclara
                                              tion)</code></pre>
</blockquote>
<p><em>Declares a relation in the spannerlog engine.</em></p>
<table class="table">
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>relation_decl</td>
<td>RelationDeclaration</td>
<td>a relation declaration</td>
</tr>
<tr class="even">
<td><strong>Returns</strong></td>
<td><strong>None</strong></td>
<td></td>
</tr>
</tbody>
</table>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>if the relation is already declared does nothing.</p>
</div>
</div>
<hr>
<p><a href="https://github.com/DeanLight/spannerlib/blob/master/spannerlib/engine.py#L74" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="spannerlogenginebase.add_fact" class="level3">
<h3 class="anchored" data-anchor-id="spannerlogenginebase.add_fact">spannerlogEngineBase.add_fact</h3>
<blockquote class="blockquote">
<pre><code> spannerlogEngineBase.add_fact (fact:spannerlib.ast_node_types.AddFact)</code></pre>
</blockquote>
<p><em>Adds a fact to the spannerlog engine.</em></p>
<table class="table">
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>fact</td>
<td>AddFact</td>
<td>the fact to be added</td>
</tr>
<tr class="even">
<td><strong>Returns</strong></td>
<td><strong>None</strong></td>
<td></td>
</tr>
</tbody>
</table>
<hr>
<p><a href="https://github.com/DeanLight/spannerlib/blob/master/spannerlib/engine.py#L83" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="spannerlogenginebase.remove_fact" class="level3">
<h3 class="anchored" data-anchor-id="spannerlogenginebase.remove_fact">spannerlogEngineBase.remove_fact</h3>
<blockquote class="blockquote">
<pre><code> spannerlogEngineBase.remove_fact
                                   (fact:spannerlib.ast_node_types.RemoveF
                                   act)</code></pre>
</blockquote>
<p><em>Removes a fact from the spannerlog engine.</em></p>
<table class="table">
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>fact</td>
<td>RemoveFact</td>
<td>the fact to be removed</td>
</tr>
<tr class="even">
<td><strong>Returns</strong></td>
<td><strong>None</strong></td>
<td></td>
</tr>
</tbody>
</table>
<hr>
<p><a href="https://github.com/DeanLight/spannerlib/blob/master/spannerlib/engine.py#L92" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="spannerlogenginebase.query" class="level3">
<h3 class="anchored" data-anchor-id="spannerlogenginebase.query">spannerlogEngineBase.query</h3>
<blockquote class="blockquote">
<pre><code> spannerlogEngineBase.query (query:spannerlib.ast_node_types.Query)</code></pre>
</blockquote>
<p>*Queries the spannerlog engine. Outputs a preformatted query result, e.g.&nbsp;[(“a”,5),(“b”,6)]. notice that <a href="https://DeanLight.github.io/spannerlib/engine.html#query"><code>query</code></a> isn’t a string; it’s a <a href="https://DeanLight.github.io/spannerlib/ast_node_types.html#query"><code>Query</code></a> object which inherits from <a href="https://DeanLight.github.io/spannerlib/ast_node_types.html#relation"><code>Relation</code></a>. <br> for example, parsing the string <code>?excellent("bill","ted")</code> yields the following <a href="https://DeanLight.github.io/spannerlib/ast_node_types.html#query"><code>Query</code></a>:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode prolog code-with-copy"><code class="sourceCode prolog"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>relation_name <span class="kw">=</span> excellent</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>term_list <span class="kw">=</span> [<span class="ot">"</span><span class="er">bill</span><span class="ot">"</span>, <span class="ot">"</span><span class="er">ted</span><span class="ot">"</span>]</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>type_list <span class="kw">=</span> [<span class="dt">DataTypes</span>.string, <span class="dt">DataTypes</span>.string]</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="st">`</span><span class="ch">``</span><span class="er">*</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="er">|    | **Type** | **Details** |</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="er">| -- | -------- | ----------- |</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="er">| query | Query | a query for the spannerlog engine |</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="er">| **Returns** | **List[Tuple]** | **a list of tuples that are the query's results** |</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="er">---</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="er">[source](https://github.com/DeanLight/spannerlib/blob/master/spannerlib/engine.py#L110){target="_blank" style="float:right; font-size:smaller"}</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a><span class="er">### spannerlogEngineBase.remove_tables</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;      spannerlogEngineBase.remove_tables (tables_names:Iterable[str])</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a><span class="er">*Removes all the tables inside the input from sql.*</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a><span class="er">|    | **Type** | **Details** |</span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a><span class="er">| -- | -------- | ----------- |</span></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a><span class="er">| tables_names | Iterable[str] | tables to remove |</span></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a><span class="er">| **Returns** | **None** |  |</span></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a><span class="er">---</span></span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a><span class="er">[source](https://github.com/DeanLight/spannerlib/blob/master/spannerlib/engine.py#L119){target="_blank" style="float:right; font-size:smaller"}</span></span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a><span class="er">### spannerlogEngineBase.clear_relation</span></span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;      spannerlogEngineBase.clear_relation (table:str)</span></span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a><span class="er">*Resets the table (deletes all its tuples).*</span></span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a><span class="er">|    | **Type** | **Details** |</span></span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a><span class="er">| -- | -------- | ----------- |</span></span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a><span class="er">| table | str | tables to reset |</span></span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a><span class="er">| **Returns** | **None** |  |</span></span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a><span class="er">---</span></span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-46"><a href="#cb9-46" aria-hidden="true" tabindex="-1"></a><span class="er">[source](https://github.com/DeanLight/spannerlib/blob/master/spannerlib/engine.py#L127){target="_blank" style="float:right; font-size:smaller"}</span></span>
<span id="cb9-47"><a href="#cb9-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-48"><a href="#cb9-48" aria-hidden="true" tabindex="-1"></a><span class="er">### spannerlogEngineBase.clear_tables</span></span>
<span id="cb9-49"><a href="#cb9-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-50"><a href="#cb9-50" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;      spannerlogEngineBase.clear_tables (tables_names:Iterable[str])</span></span>
<span id="cb9-51"><a href="#cb9-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-52"><a href="#cb9-52" aria-hidden="true" tabindex="-1"></a><span class="er">*Resets all the tables inside the input (deletes all their tuples).*</span></span>
<span id="cb9-53"><a href="#cb9-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-54"><a href="#cb9-54" aria-hidden="true" tabindex="-1"></a><span class="er">|    | **Type** | **Details** |</span></span>
<span id="cb9-55"><a href="#cb9-55" aria-hidden="true" tabindex="-1"></a><span class="er">| -- | -------- | ----------- |</span></span>
<span id="cb9-56"><a href="#cb9-56" aria-hidden="true" tabindex="-1"></a><span class="er">| tables_names | Iterable[str] | tables to reset |</span></span>
<span id="cb9-57"><a href="#cb9-57" aria-hidden="true" tabindex="-1"></a><span class="er">| **Returns** | **None** |  |</span></span>
<span id="cb9-58"><a href="#cb9-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-59"><a href="#cb9-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-60"><a href="#cb9-60" aria-hidden="true" tabindex="-1"></a><span class="er">---</span></span>
<span id="cb9-61"><a href="#cb9-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-62"><a href="#cb9-62" aria-hidden="true" tabindex="-1"></a><span class="er">[source](https://github.com/DeanLight/spannerlib/blob/master/spannerlib/engine.py#L137){target="_blank" style="float:right; font-size:smaller"}</span></span>
<span id="cb9-63"><a href="#cb9-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-64"><a href="#cb9-64" aria-hidden="true" tabindex="-1"></a><span class="er">### spannerlogEngineBase.get_table_len</span></span>
<span id="cb9-65"><a href="#cb9-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-66"><a href="#cb9-66" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;      spannerlogEngineBase.get_table_len (table:str)</span></span>
<span id="cb9-67"><a href="#cb9-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-68"><a href="#cb9-68" aria-hidden="true" tabindex="-1"></a><span class="er">|    | **Type** | **Details** |</span></span>
<span id="cb9-69"><a href="#cb9-69" aria-hidden="true" tabindex="-1"></a><span class="er">| -- | -------- | ----------- |</span></span>
<span id="cb9-70"><a href="#cb9-70" aria-hidden="true" tabindex="-1"></a><span class="er">| table | str | name of a table |</span></span>
<span id="cb9-71"><a href="#cb9-71" aria-hidden="true" tabindex="-1"></a><span class="er">| **Returns** | **int** | **number of tuples inside the table** |</span></span>
<span id="cb9-72"><a href="#cb9-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-73"><a href="#cb9-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-74"><a href="#cb9-74" aria-hidden="true" tabindex="-1"></a><span class="er">---</span></span>
<span id="cb9-75"><a href="#cb9-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-76"><a href="#cb9-76" aria-hidden="true" tabindex="-1"></a><span class="er">[source](https://github.com/DeanLight/spannerlib/blob/master/spannerlib/engine.py#L143){target="_blank" style="float:right; font-size:smaller"}</span></span>
<span id="cb9-77"><a href="#cb9-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-78"><a href="#cb9-78" aria-hidden="true" tabindex="-1"></a><span class="er">### spannerlogEngineBase.compute_ie_relation</span></span>
<span id="cb9-79"><a href="#cb9-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-80"><a href="#cb9-80" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;      spannerlogEngineBase.compute_ie_relation</span></span>
<span id="cb9-81"><a href="#cb9-81" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;                                                (ie_relation:spannerlib.ast_nod</span></span>
<span id="cb9-82"><a href="#cb9-82" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;                                                e_types.IERelation, ie_func:spa</span></span>
<span id="cb9-83"><a href="#cb9-83" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;                                                nnerlib.ie_function.IEFunction,</span></span>
<span id="cb9-84"><a href="#cb9-84" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;                                                bounding_relation:Union[spanner</span></span>
<span id="cb9-85"><a href="#cb9-85" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;                                                lib.ast_node_types.Relation,Non</span></span>
<span id="cb9-86"><a href="#cb9-86" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;                                                eType])</span></span>
<span id="cb9-87"><a href="#cb9-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-88"><a href="#cb9-88" aria-hidden="true" tabindex="-1"></a><span class="er">*Computes an information extraction relation, returning the result as a normal relation.</span></span>
<span id="cb9-89"><a href="#cb9-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-90"><a href="#cb9-90" aria-hidden="true" tabindex="-1"></a><span class="er">since ie relations may have input free variables, we need to use another relation to determine the inputs</span></span>
<span id="cb9-91"><a href="#cb9-91" aria-hidden="true" tabindex="-1"></a><span class="er">for ie_relation.</span></span>
<span id="cb9-92"><a href="#cb9-92" aria-hidden="true" tabindex="-1"></a><span class="er">Each free variable that appears as an ie_relation input term must appear at least once in the</span></span>
<span id="cb9-93"><a href="#cb9-93" aria-hidden="true" tabindex="-1"></a><span class="er">bounding_relation terms.</span></span>
<span id="cb9-94"><a href="#cb9-94" aria-hidden="true" tabindex="-1"></a><span class="er">Should the ie relation not have any input free variables, bounding_relation can (but not must) be None</span></span>
<span id="cb9-95"><a href="#cb9-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-96"><a href="#cb9-96" aria-hidden="true" tabindex="-1"></a><span class="er">note the an ie relation is effectively two relations: a relation that defines the inputs to an ie function</span></span>
<span id="cb9-97"><a href="#cb9-97" aria-hidden="true" tabindex="-1"></a><span class="er">and a relation that filters the output of the ie functions.</span></span>
<span id="cb9-98"><a href="#cb9-98" aria-hidden="true" tabindex="-1"></a><span class="er">seeing that, we can define a general algorithm for this function:</span></span>
<span id="cb9-99"><a href="#cb9-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-100"><a href="#cb9-100" aria-hidden="true" tabindex="-1"></a><span class="er">1. using the input relation to the ie function, filter "bounding_relation" into a relation who's</span></span>
<span id="cb9-101"><a href="#cb9-101" aria-hidden="true" tabindex="-1"></a><span class="er">tuples are all of the inputs to the ie function. if the input relation has no free variable terms,</span></span>
<span id="cb9-102"><a href="#cb9-102" aria-hidden="true" tabindex="-1"></a><span class="er">it is basically a fact, i.e., a single tuple, meaning we could skip this step and just use that tuple</span></span>
<span id="cb9-103"><a href="#cb9-103" aria-hidden="true" tabindex="-1"></a><span class="er">as an input instead.</span></span>
<span id="cb9-104"><a href="#cb9-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-105"><a href="#cb9-105" aria-hidden="true" tabindex="-1"></a><span class="er">2. run the ie function on each one of the tuples of the relation we created in step 1, and save the</span></span>
<span id="cb9-106"><a href="#cb9-106" aria-hidden="true" tabindex="-1"></a><span class="er">results to a new relation (the output relation)</span></span>
<span id="cb9-107"><a href="#cb9-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-108"><a href="#cb9-108" aria-hidden="true" tabindex="-1"></a><span class="er">3. use the output relation of the ie function, filter the results we got in step 2 to a new relation</span></span>
<span id="cb9-109"><a href="#cb9-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-110"><a href="#cb9-110" aria-hidden="true" tabindex="-1"></a><span class="er">example:</span></span>
<span id="cb9-111"><a href="#cb9-111" aria-hidden="true" tabindex="-1"></a><span class="er">let's follow the steps for the ie relation "RGX&lt;X,Y&gt;-&gt;(Z,[1,2))" with the bounding relation "bind(X,Y,W)":</span></span>
<span id="cb9-112"><a href="#cb9-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-113"><a href="#cb9-113" aria-hidden="true" tabindex="-1"></a><span class="er">1. input_relation(X,Y) &lt;- bind(X,Y,W)  # filter the bounding relation tuples into the input relation</span></span>
<span id="cb9-114"><a href="#cb9-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-115"><a href="#cb9-115" aria-hidden="true" tabindex="-1"></a><span class="er">2. for each tuple in input_relation(X,Y), use it as an input for RGX(x,y) and save the result to a new</span></span>
<span id="cb9-116"><a href="#cb9-116" aria-hidden="true" tabindex="-1"></a><span class="er">relation called output_relation</span></span>
<span id="cb9-117"><a href="#cb9-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-118"><a href="#cb9-118" aria-hidden="true" tabindex="-1"></a><span class="er">3. filter the outputs of the ie function into a relation like this</span></span>
<span id="cb9-119"><a href="#cb9-119" aria-hidden="true" tabindex="-1"></a><span class="er">final_ie_result(X,Y,Z) &lt;- input_relation(X,Y), output_relation(Z,[1,2))</span></span>
<span id="cb9-120"><a href="#cb9-120" aria-hidden="true" tabindex="-1"></a><span class="er">for details on this join operation see "spannerlogEngineBase.join_relations"</span></span>
<span id="cb9-121"><a href="#cb9-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-122"><a href="#cb9-122" aria-hidden="true" tabindex="-1"></a><span class="er">note that "final_ie_result" is defined using only free variables, as an ie relation in spannerlog is merely</span></span>
<span id="cb9-123"><a href="#cb9-123" aria-hidden="true" tabindex="-1"></a><span class="er">a part of a rule body, which serves to define the rule head relation. the rule head only "cares" about</span></span>
<span id="cb9-124"><a href="#cb9-124" aria-hidden="true" tabindex="-1"></a><span class="er">free variables, so we can throw away all of the columns defined by constant terms.*</span></span>
<span id="cb9-125"><a href="#cb9-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-126"><a href="#cb9-126" aria-hidden="true" tabindex="-1"></a><span class="er">|    | **Type** | **Details** |</span></span>
<span id="cb9-127"><a href="#cb9-127" aria-hidden="true" tabindex="-1"></a><span class="er">| -- | -------- | ----------- |</span></span>
<span id="cb9-128"><a href="#cb9-128" aria-hidden="true" tabindex="-1"></a><span class="er">| ie_relation | IERelation | an ie relation that determines the input and output terms of the ie function |</span></span>
<span id="cb9-129"><a href="#cb9-129" aria-hidden="true" tabindex="-1"></a><span class="er">| ie_func | IEFunction | the data for the ie function that will be used to compute the ie relation |</span></span>
<span id="cb9-130"><a href="#cb9-130" aria-hidden="true" tabindex="-1"></a><span class="er">| bounding_relation | Optional[Relation] | a relation that contains the inputs for ie_funcs. the actual input needs to be queried from it |</span></span>
<span id="cb9-131"><a href="#cb9-131" aria-hidden="true" tabindex="-1"></a><span class="er">| **Returns** | **Relation** | **a normal relation that contains all of the resulting tuples in the spannerlog engine** |</span></span>
<span id="cb9-132"><a href="#cb9-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-133"><a href="#cb9-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-134"><a href="#cb9-134" aria-hidden="true" tabindex="-1"></a><span class="er">---</span></span>
<span id="cb9-135"><a href="#cb9-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-136"><a href="#cb9-136" aria-hidden="true" tabindex="-1"></a><span class="er">[source](https://github.com/DeanLight/spannerlib/blob/master/spannerlib/engine.py#L190){target="_blank" style="float:right; font-size:smaller"}</span></span>
<span id="cb9-137"><a href="#cb9-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-138"><a href="#cb9-138" aria-hidden="true" tabindex="-1"></a><span class="er">### spannerlogEngineBase._convert_relation_term_to_string_or_int</span></span>
<span id="cb9-139"><a href="#cb9-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-140"><a href="#cb9-140" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;      spannerlogEngineBase._convert_relation_term_to_string_or_int</span></span>
<span id="cb9-141"><a href="#cb9-141" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;                                                                    (datatype:s</span></span>
<span id="cb9-142"><a href="#cb9-142" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;                                                                    pannerlib.p</span></span>
<span id="cb9-143"><a href="#cb9-143" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;                                                                    rimitive_ty</span></span>
<span id="cb9-144"><a href="#cb9-144" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;                                                                    pes.DataTyp</span></span>
<span id="cb9-145"><a href="#cb9-145" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;                                                                    es,</span></span>
<span id="cb9-146"><a href="#cb9-146" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;                                                                    term:Any)</span></span>
<span id="cb9-147"><a href="#cb9-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-148"><a href="#cb9-148" aria-hidden="true" tabindex="-1"></a><span class="er">*Return the string/int representation of a relation term, e.g. "[1,4)"*</span></span>
<span id="cb9-149"><a href="#cb9-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-150"><a href="#cb9-150" aria-hidden="true" tabindex="-1"></a><span class="er">|    | **Type** | **Details** |</span></span>
<span id="cb9-151"><a href="#cb9-151" aria-hidden="true" tabindex="-1"></a><span class="er">| -- | -------- | ----------- |</span></span>
<span id="cb9-152"><a href="#cb9-152" aria-hidden="true" tabindex="-1"></a><span class="er">| datatype | DataTypes | the type of the term |</span></span>
<span id="cb9-153"><a href="#cb9-153" aria-hidden="true" tabindex="-1"></a><span class="er">| term | Any | the term object itself |</span></span>
<span id="cb9-154"><a href="#cb9-154" aria-hidden="true" tabindex="-1"></a><span class="er">| **Returns** | **Union[str, int]** | **string/int representation** |</span></span>
<span id="cb9-155"><a href="#cb9-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-156"><a href="#cb9-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-157"><a href="#cb9-157" aria-hidden="true" tabindex="-1"></a><span class="er">---</span></span>
<span id="cb9-158"><a href="#cb9-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-159"><a href="#cb9-159" aria-hidden="true" tabindex="-1"></a><span class="er">[source](https://github.com/DeanLight/spannerlib/blob/master/spannerlib/engine.py#L200){target="_blank" style="float:right; font-size:smaller"}</span></span>
<span id="cb9-160"><a href="#cb9-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-161"><a href="#cb9-161" aria-hidden="true" tabindex="-1"></a><span class="er">### spannerlogEngineBase.operator_select</span></span>
<span id="cb9-162"><a href="#cb9-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-163"><a href="#cb9-163" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;      spannerlogEngineBase.operator_select</span></span>
<span id="cb9-164"><a href="#cb9-164" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;                                            (relation:spannerlib.ast_node_types</span></span>
<span id="cb9-165"><a href="#cb9-165" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;                                            .Relation, select_info:Set[Tuple[in</span></span>
<span id="cb9-166"><a href="#cb9-166" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;                                            t,Any,spannerlib.primitive_types.Da</span></span>
<span id="cb9-167"><a href="#cb9-167" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;                                            taTypes]], *args:Any)</span></span>
<span id="cb9-168"><a href="#cb9-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-169"><a href="#cb9-169" aria-hidden="true" tabindex="-1"></a><span class="er">*The </span><span class="st">[`</span>operator_select<span class="st">`</span><span class="er">](https://DeanLight.github.io/spannerlib/engine.html#operator_select) function operates on a relation, which is represented as a database table, and a set of constant variables. Its primary objective is to filter tuples from the given relation based on certain conditions and return the filtered relation.</span></span>
<span id="cb9-170"><a href="#cb9-170" aria-hidden="true" tabindex="-1"></a><span class="er">For instance, consider the rule: </span></span>
<span id="cb9-171"><a href="#cb9-171" aria-hidden="true" tabindex="-1"></a><span class="er">``</span><span class="st">`</span>prolog</span>
<span id="cb9-172"><a href="#cb9-172" aria-hidden="true" tabindex="-1"></a>brothers_of_jack(<span class="dt">X</span>) &lt;- brothers(<span class="dt">X</span><span class="kw">,</span> <span class="ot">"</span><span class="er">Jack</span><span class="ot">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The goal is to print all the brothers of “Jack” by retrieving tuples from the “brothers” relation table in the database where “Jack” appears on the right side of the tuple. The operator_select function serves precisely this purpose.*</p>
<table class="table">
<colgroup>
<col style="width: 9%">
<col style="width: 38%">
<col style="width: 52%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>relation</td>
<td>Relation</td>
<td>the relation from which we select tuples</td>
</tr>
<tr class="even">
<td>select_info</td>
<td>Set[Tuple[int, Any, DataTypes]]</td>
<td>set of tuples. each tuple contains the index of the column, the value to select and the type of the column</td>
</tr>
<tr class="odd">
<td>args</td>
<td>Any</td>
<td></td>
</tr>
<tr class="even">
<td><strong>Returns</strong></td>
<td><strong>Relation</strong></td>
<td><strong>a filtered relation</strong></td>
</tr>
</tbody>
</table>
<hr>
<p><a href="https://github.com/DeanLight/spannerlib/blob/master/spannerlib/engine.py#L217" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="spannerlogenginebase.operator_join" class="level3">
<h3 class="anchored" data-anchor-id="spannerlogenginebase.operator_join">spannerlogEngineBase.operator_join</h3>
<blockquote class="blockquote">
<pre><code> spannerlogEngineBase.operator_join
                                     (relations:List[spannerlib.ast_node_t
                                     ypes.Relation], *args:Any)</code></pre>
</blockquote>
<p>*The <a href="https://DeanLight.github.io/spannerlib/engine.html#operator_join"><code>operator_join</code></a> function operates on a list of relations and its primary objective is to generate a logical AND operator among the tables of those relations within the database. <br> This function plays a crucial role in situations where the following rule is defined: <br></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode prolog code-with-copy"><code class="sourceCode prolog"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>grandparent(<span class="dt">X</span><span class="kw">,</span><span class="dt">Z</span>) &lt;- parent(<span class="dt">X</span><span class="kw">,</span><span class="dt">Y</span>)<span class="kw">,</span> parent(<span class="dt">Y</span><span class="kw">,</span><span class="dt">Z</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The purpose of creating a relation through the <a href="https://DeanLight.github.io/spannerlib/engine.html#operator_join"><code>operator_join</code></a> function is to establish a connection between the columns containing all possible combinations of triplets (X, Y, Z) where both <code>parent(X,Y)</code> and <code>parent(Y,Z)</code> evaluate to true. <br> The reason for having three columns instead of two is to ensure that we have an answer for every query pertaining to the grandparent rule. <br> With three free variables, it becomes essential to capture all possible combinations in order to provide comprehensive responses to queries. <br> Subsequently, the columns required by a specific query can be projected at a later stage. <br>*</p>
<table class="table">
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>relations</td>
<td>List[Relation]</td>
<td>a list of normal relations</td>
</tr>
<tr class="even">
<td>args</td>
<td>Any</td>
<td></td>
</tr>
<tr class="odd">
<td><strong>Returns</strong></td>
<td><strong>Relation</strong></td>
<td><strong>a new relation as described above</strong></td>
</tr>
</tbody>
</table>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>It should be noted that the relation generated at this point represents the logical AND operation applied to all the relations within the rule’s body relation, considering the free variables involved.</p>
</div>
</div>
<hr>
<p><a href="https://github.com/DeanLight/spannerlib/blob/master/spannerlib/engine.py#L237" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="spannerlogenginebase.operator_project" class="level3">
<h3 class="anchored" data-anchor-id="spannerlogenginebase.operator_project">spannerlogEngineBase.operator_project</h3>
<blockquote class="blockquote">
<pre><code> spannerlogEngineBase.operator_project
                                        (relation:spannerlib.ast_node_type
                                        s.Relation,
                                        project_vars:List[str], *args:Any)</code></pre>
</blockquote>
<p>*The <a href="https://DeanLight.github.io/spannerlib/engine.html#operator_project"><code>operator_project</code></a> function operates on a relation, which is represented as a database table, and a list of project variables. <br> Its primary objective is to yield a relation with the projected variables of the src_relation.</p>
<p>Continuing from the previous example, once the select relation table is added to the database, it consists of two columns where “Jack” appears on the right-hand side. <br> However, the purpose of the query is to print only a single column containing the brothers of “Jack”, without including the right column that holds the value “Jack”. <br></p>
<p>To address this requirement, the <a href="https://DeanLight.github.io/spannerlib/engine.html#operator_project"><code>operator_project</code></a> comes into play. <br> Its primary objective is to operate on the relation resulting from the select operation and generate another relation where “Jack” no longer appears on the right-hand side.*</p>
<table class="table">
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>relation</td>
<td>Relation</td>
<td>the relation on which we project</td>
</tr>
<tr class="even">
<td>project_vars</td>
<td>List[str]</td>
<td>a list of variables on which we project</td>
</tr>
<tr class="odd">
<td>args</td>
<td>Any</td>
<td></td>
</tr>
<tr class="even">
<td><strong>Returns</strong></td>
<td><strong>Relation</strong></td>
<td><strong>the projected relation</strong></td>
</tr>
</tbody>
</table>
<hr>
<p><a href="https://github.com/DeanLight/spannerlib/blob/master/spannerlib/engine.py#L255" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="spannerlogenginebase.operator_union" class="level3">
<h3 class="anchored" data-anchor-id="spannerlogenginebase.operator_union">spannerlogEngineBase.operator_union</h3>
<blockquote class="blockquote">
<pre><code> spannerlogEngineBase.operator_union
                                      (relations:List[spannerlib.ast_node_
                                      types.Relation], *args:Any)</code></pre>
</blockquote>
<p>*a rule can be defined multiple times as long as it shares the same rule head. To illustrate this, let’s consider the following example:</p>
<p>Suppose we have the rules:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode prolog code-with-copy"><code class="sourceCode prolog"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="dt">A</span>(<span class="dt">X</span><span class="kw">,</span><span class="dt">Y</span>) &lt;- <span class="dt">B</span>(<span class="dt">X</span><span class="kw">,</span><span class="dt">Y</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="dt">A</span>(<span class="dt">X</span><span class="kw">,</span><span class="dt">Y</span>) &lt;- <span class="dt">C</span>(<span class="dt">X</span><span class="kw">,</span><span class="dt">Y</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>If we execute the query <code>?A(X,Y)</code>, the engine will produce results that include tuples from both <code>B(X,Y)</code> and <code>C(X,Y)</code> relations.</p>
<p>Here’s how the engine handles this scenario: <br> 1. <strong>Rule Matching</strong>: The engine identifies all the rules that have the same rule head (<code>A(X,Y)</code>) as the queried relation. <br> 2. <strong>Rule Execution</strong>: For each matched rule, the engine executes all the steps described earlier, such as assigning temporary names, performing joins, and creating intermediate relations, selecting and filtering. <br> 3. <strong>Intermediate Relations</strong>: At this stage, we have intermediate relations generated for each rule, containing the relevant tuples based on the rule’s body. <br> 4. <strong>Operator Union</strong>: To consolidate the results from all the rules into a single unified relation, the operator union is applied. This operation combines the tuples from all the intermediate relations. <br></p>
<p>The <a href="https://DeanLight.github.io/spannerlib/engine.html#operator_union"><code>operator_union</code></a> ensures that the final unified relation contains all the tuples from the individual intermediate relations, effectively merging the results obtained from different rule instances with the same rule head. In summary, the engine processes each rule with the same rule head as the queried relation, performs the necessary steps for each rule individually, and then applies the operator union to merge the intermediate relations into a single unified relation, ensuring all relevant tuples are included in the final result. <span class="citation" data-cites="note">@note</span>: we assume that all the relations have same free_vars in the same order.*</p>
<table class="table">
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>relations</td>
<td>List[Relation]</td>
<td>a list of relations to unite</td>
</tr>
<tr class="even">
<td>args</td>
<td>Any</td>
<td></td>
</tr>
<tr class="odd">
<td><strong>Returns</strong></td>
<td><strong>Relation</strong></td>
<td><strong>the united relation</strong></td>
</tr>
</tbody>
</table>
<hr>
<p><a href="https://github.com/DeanLight/spannerlib/blob/master/spannerlib/engine.py#L282" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="spannerlogenginebase.operator_copy" class="level3">
<h3 class="anchored" data-anchor-id="spannerlogenginebase.operator_copy">spannerlogEngineBase.operator_copy</h3>
<blockquote class="blockquote">
<pre><code> spannerlogEngineBase.operator_copy
                                     (src_rel:spannerlib.ast_node_types.Re
                                     lation, output_relation:Union[spanner
                                     lib.ast_node_types.Relation,NoneType]
                                     =None, *args:Any)</code></pre>
</blockquote>
<p><em>Copies computed_relation to rule_relation.</em></p>
<table class="table">
<colgroup>
<col style="width: 6%">
<col style="width: 25%">
<col style="width: 34%">
<col style="width: 34%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>src_rel</td>
<td>Relation</td>
<td></td>
<td>the relation to copy from</td>
</tr>
<tr class="even">
<td>output_relation</td>
<td>Optional[Relation]</td>
<td>None</td>
<td>if this is None, create a unique name for the output relation. otherwise, this will be the name of the output relation</td>
</tr>
<tr class="odd">
<td>args</td>
<td>Any</td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td><strong>Returns</strong></td>
<td><strong>Relation</strong></td>
<td></td>
<td><strong>the copied relation</strong></td>
</tr>
</tbody>
</table>
<hr>
<p><a href="https://github.com/DeanLight/spannerlib/blob/master/spannerlib/engine.py#L292" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="sqliteengine" class="level3">
<h3 class="anchored" data-anchor-id="sqliteengine">SqliteEngine</h3>
<blockquote class="blockquote">
<pre><code> SqliteEngine (database_name:Optional[str]=None)</code></pre>
</blockquote>
<p><em>in this implementation of the engine, we use python’s sqlite3, which allows creating an SQL database easily, without using servers. the engine is called from <code>GenericExecution</code>, and uses <code>run_sql</code> as an interface to the database, which queries/modifies a table. each <code>operator</code> method implements a relational algebra operator by constructing an SQL command and executing it.</em></p>
<table class="table">
<colgroup>
<col style="width: 6%">
<col style="width: 25%">
<col style="width: 34%">
<col style="width: 34%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>database_name</td>
<td>Optional[str]</td>
<td>None</td>
<td>open an existing database instead of a new one</td>
</tr>
</tbody>
</table>
<hr>
</section>
<section id="sqliteengine.is_table_exists" class="level3">
<h3 class="anchored" data-anchor-id="sqliteengine.is_table_exists">SqliteEngine.is_table_exists</h3>
<blockquote class="blockquote">
<pre><code> SqliteEngine.is_table_exists (table_name:str)</code></pre>
</blockquote>
<p><em>Checks whether a table exists in the database.</em></p>
<table class="table">
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>table_name</td>
<td>str</td>
<td>the table which is checked for existence.</td>
</tr>
<tr class="even">
<td><strong>Returns</strong></td>
<td><strong>bool</strong></td>
<td><strong>True if it exists, else False.</strong></td>
</tr>
</tbody>
</table>
<hr>
</section>
<section id="sqliteengine.remove_table" class="level3">
<h3 class="anchored" data-anchor-id="sqliteengine.remove_table">SqliteEngine.remove_table</h3>
<blockquote class="blockquote">
<pre><code> SqliteEngine.remove_table (table_name:str)</code></pre>
</blockquote>
<p><em>Removes a table from the sql database, if it exists.</em></p>
<table class="table">
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>table_name</td>
<td>str</td>
<td>the table to remove</td>
</tr>
</tbody>
</table>
<hr>
</section>
<section id="sqliteengine.remove_tables" class="level3">
<h3 class="anchored" data-anchor-id="sqliteengine.remove_tables">SqliteEngine.remove_tables</h3>
<blockquote class="blockquote">
<pre><code> SqliteEngine.remove_tables (table_names:Iterable[str])</code></pre>
</blockquote>
<p><em>Removes the given tables from sql.</em></p>
<table class="table">
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>table_names</td>
<td>Iterable[str]</td>
<td>tables to remove</td>
</tr>
</tbody>
</table>
<hr>
<p><a href="https://github.com/DeanLight/spannerlib/blob/master/spannerlib/engine.py#L946" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="operator_copy" class="level3">
<h3 class="anchored" data-anchor-id="operator_copy">operator_copy</h3>
<blockquote class="blockquote">
<pre><code> operator_copy (src_rel:spannerlib.ast_node_types.Relation,
                output_relation:Union[spannerlib.ast_node_types.Relation,N
                oneType]=None, *args:Any)</code></pre>
</blockquote>
<p><em>See <a href="https://DeanLight.github.io/spannerlib/engine.html#spannerlogenginebase.operator_copy"><code>spannerlogEngineBase.operator_copy</code></a> for explanation</em></p>
<hr>
</section>
<section id="sqliteengine.compute_ie_relation" class="level3">
<h3 class="anchored" data-anchor-id="sqliteengine.compute_ie_relation">SqliteEngine.compute_ie_relation</h3>
<blockquote class="blockquote">
<pre><code> SqliteEngine.compute_ie_relation
                                   (ie_relation:spannerlib.ast_node_types.
                                   IERelation, ie_func:spannerlib.ie_funct
                                   ion.IEFunction, bounding_relation:Union
                                   [spannerlib.ast_node_types.Relation,Non
                                   eType])</code></pre>
</blockquote>
<p><em>Computes an information extraction relation, returning the result as a normal relation. for more details see spannerlogEngineBase.compute_ie_relation. notice comments below regarding constants</em></p>
<table class="table">
<colgroup>
<col style="width: 9%">
<col style="width: 38%">
<col style="width: 52%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>ie_relation</td>
<td>IERelation</td>
<td>an ie relation that determines the input and output terms of the ie function</td>
</tr>
<tr class="even">
<td>ie_func</td>
<td>IEFunction</td>
<td>the ie function that will be used to compute the ie relation</td>
</tr>
<tr class="odd">
<td>bounding_relation</td>
<td>Optional[Relation]</td>
<td>a relation that contains the inputs for ie_funcs. the actual input needs to be queried from it</td>
</tr>
<tr class="even">
<td><strong>Returns</strong></td>
<td><strong>Relation</strong></td>
<td><strong>a normal relation that contains all of the resulting tuples in the spannerlog engine</strong></td>
</tr>
</tbody>
</table>
<hr>
</section>
<section id="sqliteengine.add_fact" class="level3">
<h3 class="anchored" data-anchor-id="sqliteengine.add_fact">SqliteEngine.add_fact</h3>
<blockquote class="blockquote">
<pre><code> SqliteEngine.add_fact (fact:spannerlib.ast_node_types.AddFact)</code></pre>
</blockquote>
<p><em>Add a row into an existing sql table, based on <code>fact</code>’s terms and types</em></p>
<table class="table">
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>fact</td>
<td>AddFact</td>
<td>the fact to be added</td>
</tr>
<tr class="even">
<td><strong>Returns</strong></td>
<td><strong>None</strong></td>
<td></td>
</tr>
</tbody>
</table>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Example
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div id="cell-30" class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>my_engine <span class="op">=</span> SqliteEngine()</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>relation <span class="op">=</span> RelationDeclaration(<span class="st">"yoyo"</span>, [DataTypes.integer, DataTypes.string])</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>my_engine.declare_relation_table(relation)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>facts <span class="op">=</span> [</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>    AddFact(<span class="st">"yoyo"</span>, [<span class="dv">10</span>, <span class="st">"hello"</span>], [DataTypes.integer, DataTypes.string]),</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>    AddFact(<span class="st">"yoyo"</span>, [<span class="dv">15</span>, <span class="st">"world"</span>], [DataTypes.integer, DataTypes.string])</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> fact <span class="kw">in</span> facts:</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>    my_engine.add_fact(fact)</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>my_engine.table_to_dataframe(<span class="st">"yoyo"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">col0</th>
<th data-quarto-table-cell-role="th">col1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>10</td>
<td>hello</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>15</td>
<td>world</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
</div>
</div>
</div>
<hr>
</section>
<section id="sqliteengine.remove_fact" class="level3">
<h3 class="anchored" data-anchor-id="sqliteengine.remove_fact">SqliteEngine.remove_fact</h3>
<blockquote class="blockquote">
<pre><code> SqliteEngine.remove_fact (fact:spannerlib.ast_node_types.RemoveFact)</code></pre>
</blockquote>
<p><em>Remove a row from an existing sql table, based on <code>fact</code>’s terms and types</em></p>
<table class="table">
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>fact</td>
<td>RemoveFact</td>
<td>the fact to be removed</td>
</tr>
<tr class="even">
<td><strong>Returns</strong></td>
<td><strong>None</strong></td>
<td></td>
</tr>
</tbody>
</table>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Example
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div id="cell-34" class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>my_engine <span class="op">=</span> SqliteEngine()</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>relation <span class="op">=</span> RelationDeclaration(<span class="st">"yoyo"</span>, [DataTypes.integer, DataTypes.string])</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>my_engine.declare_relation_table(relation)</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>facts <span class="op">=</span> [</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>    AddFact(<span class="st">"yoyo"</span>, [<span class="dv">10</span>, <span class="st">"hello"</span>], [DataTypes.integer, DataTypes.string]),</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>    AddFact(<span class="st">"yoyo"</span>, [<span class="dv">15</span>, <span class="st">"world"</span>], [DataTypes.integer, DataTypes.string])</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> fact <span class="kw">in</span> facts:</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>    my_engine.add_fact(fact)</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>my_engine.table_to_dataframe(<span class="st">"yoyo"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">col0</th>
<th data-quarto-table-cell-role="th">col1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>10</td>
<td>hello</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>15</td>
<td>world</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<div id="cell-35" class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>my_engine.remove_fact(RemoveFact(<span class="st">"yoyo"</span>, [<span class="dv">15</span>, <span class="st">"world"</span>], [DataTypes.integer, DataTypes.string]))</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>my_engine.table_to_dataframe(<span class="st">"yoyo"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">col0</th>
<th data-quarto-table-cell-role="th">col1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>10</td>
<td>hello</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
</div>
</div>
</div>
<hr>
</section>
<section id="sqliteengine.query" class="level3">
<h3 class="anchored" data-anchor-id="sqliteengine.query">SqliteEngine.query</h3>
<blockquote class="blockquote">
<pre><code> SqliteEngine.query (query:spannerlib.ast_node_types.Query,
                     allow_duplicates:bool=False)</code></pre>
</blockquote>
<p>*Outputs a preformatted query result, e.g.&nbsp;[(“a”,5),(“b”,6)]. notice that <a href="https://DeanLight.github.io/spannerlib/engine.html#query"><code>query</code></a> isn’t a string; it’s a <a href="https://DeanLight.github.io/spannerlib/ast_node_types.html#query"><code>Query</code></a> object which inherits from <a href="https://DeanLight.github.io/spannerlib/ast_node_types.html#relation"><code>Relation</code></a>. for example, parsing the string <code>?excellent("bill","ted")</code> yields the following <a href="https://DeanLight.github.io/spannerlib/ast_node_types.html#query"><code>Query</code></a>:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode prolog code-with-copy"><code class="sourceCode prolog"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>relation_name <span class="kw">=</span> excellent</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>term_list <span class="kw">=</span> [<span class="ot">"</span><span class="er">bill</span><span class="ot">"</span>, <span class="ot">"</span><span class="er">ted</span><span class="ot">"</span>]</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>type_list <span class="kw">=</span> [<span class="dt">DataType</span>.string, <span class="dt">DataType</span>.string]</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="st">`</span><span class="ch">``</span><span class="er">*</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="er">|    | **Type** | **Default** | **Details** |</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="er">| -- | -------- | ----------- | ----------- |</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a><span class="er">| query | Query |  | the query to be performed |</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a><span class="er">| allow_duplicates | bool | False | if True, query result may contain duplicate values |</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a><span class="er">| **Returns** | **List[Tuple]** |  | **a query results which is True, False, or a list of tuples** |</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a><span class="er">::: {.callout-note collapse="true"}</span></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a><span class="er">##### Example</span></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a><span class="er">::: {#cell-39 .cell}</span></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a><span class="er">``</span><span class="st">`</span> <span class="kw">{</span>.python .cell<span class="fu">-</span>code<span class="kw">}</span></span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>relation <span class="kw">=</span> <span class="dt">RelationDeclaration</span>(<span class="ot">"</span><span class="er">people</span><span class="ot">"</span><span class="kw">,</span> [<span class="dt">DataTypes</span>.<span class="dt">integer</span>, <span class="dt">DataTypes</span>.string])</span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>my_engine<span class="kw">.</span>declare_relation_table(relation)</span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>facts <span class="kw">=</span> [</span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>    <span class="dt">AddFact</span>(<span class="ot">"</span><span class="er">people</span><span class="ot">"</span><span class="kw">,</span> [<span class="dv">1</span>, <span class="ot">"</span><span class="er">Alice</span><span class="ot">"</span>]<span class="kw">,</span> [<span class="dt">DataTypes</span>.<span class="dt">integer</span>, <span class="dt">DataTypes</span>.string]),</span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>    <span class="dt">AddFact</span>(<span class="ot">"</span><span class="er">people</span><span class="ot">"</span><span class="kw">,</span> [<span class="dv">2</span>, <span class="ot">"</span><span class="er">Bob</span><span class="ot">"</span>]<span class="kw">,</span> [<span class="dt">DataTypes</span>.<span class="dt">integer</span>, <span class="dt">DataTypes</span>.string])</span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a>for fact in facts<span class="fu">:</span></span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a>    my_engine<span class="kw">.</span>add_fact(fact)</span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a>query_result <span class="kw">=</span> my_engine<span class="kw">.</span>query(<span class="dt">Query</span>(<span class="ot">"</span><span class="er">people</span><span class="ot">"</span><span class="kw">,</span> [<span class="ot">"</span><span class="er">ID</span><span class="ot">"</span>, <span class="ot">"</span><span class="er">Name</span><span class="ot">"</span>]<span class="kw">,</span></span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a>                                        [<span class="dt">DataTypes</span>.free_var_name, <span class="dt">DataTypes</span>.free_var_name]))</span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a>print(query_result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[(1, 'Alice'), (2, 'Bob')]</code></pre>
</div>
<p>:::</p>
<p>:::</p>
<hr>
</section>
<section id="sqliteengine.declare_relation_table" class="level3">
<h3 class="anchored" data-anchor-id="sqliteengine.declare_relation_table">SqliteEngine.declare_relation_table</h3>
<blockquote class="blockquote">
<pre><code> SqliteEngine.declare_relation_table
                                      (relation_decl:spannerlib.ast_node_t
                                      ypes.RelationDeclaration)</code></pre>
</blockquote>
<p><em>Declares a relation as an SQL table, whose types are named t0, t1, … if the relation is already declared, do nothing.</em></p>
<table class="table">
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>relation_decl</td>
<td>RelationDeclaration</td>
<td>the declaration info</td>
</tr>
</tbody>
</table>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Example
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div id="cell-43" class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>my_engine <span class="op">=</span> SqliteEngine()</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>relation <span class="op">=</span> RelationDeclaration(<span class="st">"people"</span>, [DataTypes.integer, DataTypes.string])</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>my_engine.declare_relation_table(relation)</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>my_engine.is_table_exists(<span class="st">"people"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>True</code></pre>
</div>
</div>
</div>
</div>
</div>
<hr>
<p><a href="https://github.com/DeanLight/spannerlib/blob/master/spannerlib/engine.py#L662" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="operator_select" class="level3">
<h3 class="anchored" data-anchor-id="operator_select">operator_select</h3>
<blockquote class="blockquote">
<pre><code> operator_select (src_relation:spannerlib.ast_node_types.Relation, constan
                  t_variables_info:Set[Tuple[int,Any,spannerlib.primitive_
                  types.DataTypes]], *args:Any)</code></pre>
</blockquote>
<p><em>Performs sql WHERE, whose constraints are based on <code>select_info</code></em></p>
<table class="table">
<colgroup>
<col style="width: 9%">
<col style="width: 38%">
<col style="width: 52%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>src_relation</td>
<td>Relation</td>
<td>the relation from which we select tuples</td>
</tr>
<tr class="even">
<td>constant_variables_info</td>
<td>Set[Tuple[int, Any, DataTypes]]</td>
<td>a set of tuples. each tuple contains the index of the column, the value to select (a constant variable), and the type of the column</td>
</tr>
<tr class="odd">
<td>args</td>
<td>Any</td>
<td></td>
</tr>
<tr class="even">
<td><strong>Returns</strong></td>
<td><strong>Relation</strong></td>
<td><strong>a filtered relation</strong></td>
</tr>
</tbody>
</table>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Example
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div id="cell-47" class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>my_engine <span class="op">=</span> SqliteEngine()</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>relation <span class="op">=</span> RelationDeclaration(<span class="st">"wordy"</span>, [DataTypes.string, DataTypes.string, DataTypes.string, DataTypes.string])</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>my_engine.declare_relation_table(relation)</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>facts <span class="op">=</span> [</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>    AddFact(<span class="st">"wordy"</span>, [<span class="st">"apple"</span>, <span class="st">"banana"</span>, <span class="st">"cherry"</span>, <span class="st">"date"</span>], [DataTypes.string, DataTypes.string, DataTypes.string, DataTypes.string]),</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>    AddFact(<span class="st">"wordy"</span>, [<span class="st">"pear"</span>, <span class="st">"kiwi"</span>, <span class="st">"lemon"</span>, <span class="st">"mango"</span>], [DataTypes.string, DataTypes.string, DataTypes.string, DataTypes.string]),</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>    AddFact(<span class="st">"wordy"</span>, [<span class="st">"pear"</span>, <span class="st">"quince"</span>, <span class="st">"raspberry"</span>, <span class="st">"pear"</span>], [DataTypes.string, DataTypes.string, DataTypes.string, DataTypes.string]),</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> fact <span class="kw">in</span> facts:</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>    my_engine.add_fact(fact)</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>relation_res <span class="op">=</span> my_engine.operator_select(Relation(<span class="st">"wordy"</span>, [<span class="st">"pear"</span>,<span class="st">"Y"</span>,<span class="st">"Z"</span>,<span class="st">"W"</span>], [DataTypes.string, DataTypes.free_var_name, DataTypes.free_var_name, DataTypes.free_var_name]),[(<span class="dv">0</span>,<span class="st">'pear'</span>,DataTypes.string)])</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(my_engine.table_to_dataframe(relation_res.relation_name))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   col0    col1       col2   col3
0  pear    kiwi      lemon  mango
1  pear  quince  raspberry   pear</code></pre>
</div>
</div>
</div>
</div>
</div>
<hr>
</section>
<section id="sqliteengine.operator_join" class="level3">
<h3 class="anchored" data-anchor-id="sqliteengine.operator_join">SqliteEngine.operator_join</h3>
<blockquote class="blockquote">
<pre><code> SqliteEngine.operator_join
                             (relations:List[spannerlib.ast_node_types.Rel
                             ation], *args:Any)</code></pre>
</blockquote>
<p><em>note: SQL’s inner_join without <code>IN</code> is actually cross-join (product), so this covers product as well.</em></p>
<table class="table">
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>relations</td>
<td>List[Relation]</td>
<td>a list of normal relation</td>
</tr>
<tr class="even">
<td>args</td>
<td>Any</td>
<td></td>
</tr>
<tr class="odd">
<td><strong>Returns</strong></td>
<td><strong>Relation</strong></td>
<td><strong>a new relation as described above</strong></td>
</tr>
</tbody>
</table>
<hr>
<p><a href="https://github.com/DeanLight/spannerlib/blob/master/spannerlib/engine.py#L855" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="operator_project" class="level3">
<h3 class="anchored" data-anchor-id="operator_project">operator_project</h3>
<blockquote class="blockquote">
<pre><code> operator_project (src_relation:spannerlib.ast_node_types.Relation,
                   project_vars:List[str], *args:Any)</code></pre>
</blockquote>
<p><em>Performs SQL select.</em></p>
<table class="table">
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>src_relation</td>
<td>Relation</td>
<td>the relation on which we project</td>
</tr>
<tr class="even">
<td>project_vars</td>
<td>List[str]</td>
<td>a list of variables on which we project</td>
</tr>
<tr class="odd">
<td>args</td>
<td>Any</td>
<td></td>
</tr>
<tr class="even">
<td><strong>Returns</strong></td>
<td><strong>Relation</strong></td>
<td><strong>the projected relation</strong></td>
</tr>
</tbody>
</table>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Example
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div id="cell-52" class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>my_engine <span class="op">=</span> SqliteEngine()</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>relation <span class="op">=</span> RelationDeclaration(<span class="st">"wordy"</span>, [DataTypes.string, DataTypes.string, DataTypes.string, DataTypes.string])</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>my_engine.declare_relation_table(relation)</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>facts <span class="op">=</span> [</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>    AddFact(<span class="st">"wordy"</span>, [<span class="st">"apple"</span>, <span class="st">"banana"</span>, <span class="st">"cherry"</span>, <span class="st">"date"</span>], [DataTypes.string, DataTypes.string, DataTypes.string, DataTypes.string]),</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>    AddFact(<span class="st">"wordy"</span>, [<span class="st">"pear"</span>, <span class="st">"kiwi"</span>, <span class="st">"lemon"</span>, <span class="st">"mango"</span>], [DataTypes.string, DataTypes.string, DataTypes.string, DataTypes.string]),</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>    AddFact(<span class="st">"wordy"</span>, [<span class="st">"pear"</span>, <span class="st">"quince"</span>, <span class="st">"raspberry"</span>, <span class="st">"pear"</span>], [DataTypes.string, DataTypes.string, DataTypes.string, DataTypes.string]),</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> fact <span class="kw">in</span> facts:</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>    my_engine.add_fact(fact)</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>project_relation <span class="op">=</span> my_engine.operator_select(Relation(<span class="st">"wordy"</span>, [<span class="st">"pear"</span>,<span class="st">"Y"</span>,<span class="st">"Z"</span>,<span class="st">"W"</span>], [DataTypes.string, DataTypes.free_var_name, DataTypes.free_var_name, DataTypes.free_var_name]),[(<span class="dv">0</span>,<span class="st">'pear'</span>,DataTypes.string)])</span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>table_name <span class="op">=</span> my_engine.operator_project(project_relation, [<span class="st">'Y'</span>,<span class="st">'Z'</span>,<span class="st">'W'</span>]).relation_name</span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>my_engine.table_to_dataframe(table_name)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">col0</th>
<th data-quarto-table-cell-role="th">col1</th>
<th data-quarto-table-cell-role="th">col2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>kiwi</td>
<td>lemon</td>
<td>mango</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>quince</td>
<td>raspberry</td>
<td>pear</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
</div>
</div>
</div>
<hr>
</section>
<section id="sqliteengine.operator_union" class="level3">
<h3 class="anchored" data-anchor-id="sqliteengine.operator_union">SqliteEngine.operator_union</h3>
<blockquote class="blockquote">
<pre><code> SqliteEngine.operator_union
                              (relations:List[spannerlib.ast_node_types.Re
                              lation], *args:Any)</code></pre>
</blockquote>
<p>*a rule can be defined multiple times as long as it shares the same rule head. To illustrate this, let’s consider the following example:</p>
<p>Suppose we have the rules:</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode prolog code-with-copy"><code class="sourceCode prolog"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="dt">A</span>(<span class="dt">X</span><span class="kw">,</span><span class="dt">Y</span>) &lt;- <span class="dt">B</span>(<span class="dt">X</span><span class="kw">,</span><span class="dt">Y</span>)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="dt">A</span>(<span class="dt">X</span><span class="kw">,</span><span class="dt">Y</span>) &lt;- <span class="dt">C</span>(<span class="dt">X</span><span class="kw">,</span><span class="dt">Y</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>If we execute the query <code>?A(X,Y)</code>, the engine will produce results that include tuples from both <code>B(X,Y)</code> and <code>C(X,Y)</code> relations.</p>
<p>Here’s how the engine handles this scenario: <br> 1. <strong>Rule Matching</strong>: The engine identifies all the rules that have the same rule head (<code>A(X,Y)</code>) as the queried relation. <br> 2. <strong>Rule Execution</strong>: For each matched rule, the engine executes all the steps described earlier, such as assigning temporary names, performing joins, and creating intermediate relations, selecting and filtering. <br> 3. <strong>Intermediate Relations</strong>: At this stage, we have intermediate relations generated for each rule, containing the relevant tuples based on the rule’s body. <br> 4. <strong>Operator Union</strong>: To consolidate the results from all the rules into a single unified relation, the operator union is applied. This operation combines the tuples from all the intermediate relations. <br></p>
<p>The <a href="https://DeanLight.github.io/spannerlib/engine.html#operator_union"><code>operator_union</code></a> ensures that the final unified relation contains all the tuples from the individual intermediate relations, effectively merging the results obtained from different rule instances with the same rule head. In summary, the engine processes each rule with the same rule head as the queried relation, performs the necessary steps for each rule individually, and then applies the operator union to merge the intermediate relations into a single unified relation, ensuring all relevant tuples are included in the final result. <span class="citation" data-cites="note">@note</span>: we assume that all the relations have same free_vars in the same order.*</p>
<table class="table">
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>relations</td>
<td>List[Relation]</td>
<td>a list of relations to unite</td>
</tr>
<tr class="even">
<td>args</td>
<td>Any</td>
<td></td>
</tr>
<tr class="odd">
<td><strong>Returns</strong></td>
<td><strong>Relation</strong></td>
<td><strong>the united relation</strong></td>
</tr>
</tbody>
</table>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-9-contents" aria-controls="callout-9" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Example
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-9" class="callout-9-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div id="cell-56" class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>my_engine <span class="op">=</span> SqliteEngine()</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>relation1 <span class="op">=</span> RelationDeclaration(<span class="st">"relation1"</span>, [DataTypes.integer, DataTypes.integer])</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>my_engine.declare_relation_table(relation1)</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>facts1 <span class="op">=</span> [</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>    AddFact(<span class="st">"relation1"</span>, [<span class="st">"two"</span>, <span class="dv">2</span>], [DataTypes.string, DataTypes.integer]),</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>    AddFact(<span class="st">"relation1"</span>, [<span class="st">"four"</span>, <span class="dv">4</span>], [DataTypes.string, DataTypes.integer]),</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>    AddFact(<span class="st">"relation1"</span>, [<span class="st">"six"</span>, <span class="dv">6</span>], [DataTypes.string, DataTypes.integer]),</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> fact <span class="kw">in</span> facts1:</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>    my_engine.add_fact(fact)</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>relation2 <span class="op">=</span> RelationDeclaration(<span class="st">"relation2"</span>, [DataTypes.string, DataTypes.string])</span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>my_engine.declare_relation_table(relation2)</span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>facts2 <span class="op">=</span> [</span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>    AddFact(<span class="st">"relation2"</span>, [<span class="st">"one"</span>, <span class="dv">1</span>], [DataTypes.string, DataTypes.integer]),</span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> fact <span class="kw">in</span> facts2:</span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a>    my_engine.add_fact(fact)</span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a>rel1 <span class="op">=</span> Relation(<span class="st">"relation1"</span>, [<span class="st">"X"</span>, <span class="st">"Y"</span>], [DataTypes.free_var_name, DataTypes.free_var_name])</span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a>rel2 <span class="op">=</span> Relation(<span class="st">"relation2"</span>, [<span class="st">"Z"</span>, <span class="st">"W"</span>], [DataTypes.free_var_name, DataTypes.free_var_name])</span>
<span id="cb41-23"><a href="#cb41-23" aria-hidden="true" tabindex="-1"></a>table_name <span class="op">=</span> my_engine.operator_union([rel1,rel2]).relation_name</span>
<span id="cb41-24"><a href="#cb41-24" aria-hidden="true" tabindex="-1"></a>my_engine.table_to_dataframe(table_name)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">col0</th>
<th data-quarto-table-cell-role="th">col1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>four</td>
<td>4</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>one</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>six</td>
<td>6</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>two</td>
<td>2</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
</div>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/DeanLight\.github\.io\/spannerlib");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/DeanLight/spannerlib/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></div></div></footer></body></html>