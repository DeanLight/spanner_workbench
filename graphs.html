<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.554">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Spannerlib - Graphs</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
<meta property="og:title" content="Spannerlib - Graphs">
<meta property="og:description" content="work bench">
<meta property="og:site_name" content="Spannerlib">
<meta name="twitter:title" content="Spannerlib - Graphs">
<meta name="twitter:description" content="work bench">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Spannerlib</span>
    </a>
  </div>
        <div class="quarto-navbar-tools tools-end">
</div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">src</li><li class="breadcrumb-item"><a href="./ast_node_types.html">Graphs</a></li><li class="breadcrumb-item"><a href="./graphs.html">Graphs</a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome to Spannerlib</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Tutorials</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stdlib.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Standard library ie functions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./advanced_usage.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Advanced Usage</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./building_your_optimization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Building your own optimization</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./extended_version.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Advanced IE functions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./covid-nlp/covid_pipeline.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Covid-19 NLP Pipeline</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">src</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">
 <span class="menu-text">Generic</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./general_utils.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">General Utils</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./primitive_types.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Primitive Types</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false">
 <span class="menu-text">Grammar &amp; Parsing</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./expected_grammar.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Expected Grammar</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./symbol_table.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Symbol Table</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lark_passes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lark Passes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./passes_utils.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Passes Utils</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./optimizations_passes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Optimizations Passes</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false">
 <span class="menu-text">Engine</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./engine.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Engine</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./execution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Execution</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
 <span class="menu-text">Graphs</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ast_node_types.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Ast Nodes Types</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ie_function.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">IE Function</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./graphs.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Graphs</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./adding_inference_rules_to_term_graph.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Adding inference rules to term graph</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="false">
 <span class="menu-text">User-Interface</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./session.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Session</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#evalstate" id="toc-evalstate" class="nav-link active" data-scroll-target="#evalstate">EvalState</a></li>
  <li><a href="#termnodetype" id="toc-termnodetype" class="nav-link" data-scroll-target="#termnodetype">TermNodeType</a></li>
  <li><a href="#graphbase" id="toc-graphbase" class="nav-link" data-scroll-target="#graphbase">GraphBase</a></li>
  <li><a href="#graphbase.add_node" id="toc-graphbase.add_node" class="nav-link" data-scroll-target="#graphbase.add_node">GraphBase.add_node</a></li>
  <li><a href="#graphbase.get_root_id" id="toc-graphbase.get_root_id" class="nav-link" data-scroll-target="#graphbase.get_root_id">GraphBase.get_root_id</a></li>
  <li><a href="#graphbase.remove_node" id="toc-graphbase.remove_node" class="nav-link" data-scroll-target="#graphbase.remove_node">GraphBase.remove_node</a></li>
  <li><a href="#graphbase.add_edge" id="toc-graphbase.add_edge" class="nav-link" data-scroll-target="#graphbase.add_edge">GraphBase.add_edge</a></li>
  <li><a href="#graphbase.pre_order_dfs_from" id="toc-graphbase.pre_order_dfs_from" class="nav-link" data-scroll-target="#graphbase.pre_order_dfs_from">GraphBase.pre_order_dfs_from</a></li>
  <li><a href="#graphbase.pre_order_dfs" id="toc-graphbase.pre_order_dfs" class="nav-link" data-scroll-target="#graphbase.pre_order_dfs">GraphBase.pre_order_dfs</a></li>
  <li><a href="#graphbase.post_order_dfs_from" id="toc-graphbase.post_order_dfs_from" class="nav-link" data-scroll-target="#graphbase.post_order_dfs_from">GraphBase.post_order_dfs_from</a></li>
  <li><a href="#graphbase.post_order_dfs" id="toc-graphbase.post_order_dfs" class="nav-link" data-scroll-target="#graphbase.post_order_dfs">GraphBase.post_order_dfs</a></li>
  <li><a href="#graphbase.get_children" id="toc-graphbase.get_children" class="nav-link" data-scroll-target="#graphbase.get_children">GraphBase.get_children</a></li>
  <li><a href="#graphbase.get_child" id="toc-graphbase.get_child" class="nav-link" data-scroll-target="#graphbase.get_child">GraphBase.get_child</a></li>
  <li><a href="#graphbase.get_parents" id="toc-graphbase.get_parents" class="nav-link" data-scroll-target="#graphbase.get_parents">GraphBase.get_parents</a></li>
  <li><a href="#graphbase.get_parent" id="toc-graphbase.get_parent" class="nav-link" data-scroll-target="#graphbase.get_parent">GraphBase.get_parent</a></li>
  <li><a href="#graphbase.is_contains_node" id="toc-graphbase.is_contains_node" class="nav-link" data-scroll-target="#graphbase.is_contains_node">GraphBase.is_contains_node</a></li>
  <li><a href="#graphbase.set_node_attribute" id="toc-graphbase.set_node_attribute" class="nav-link" data-scroll-target="#graphbase.set_node_attribute">GraphBase.set_node_attribute</a></li>
  <li><a href="#graphbase.get_node_attributes" id="toc-graphbase.get_node_attributes" class="nav-link" data-scroll-target="#graphbase.get_node_attributes">GraphBase.get_node_attributes</a></li>
  <li><a href="#graphbase.get_all_nodes_with_attributes" id="toc-graphbase.get_all_nodes_with_attributes" class="nav-link" data-scroll-target="#graphbase.get_all_nodes_with_attributes">GraphBase.get_all_nodes_with_attributes</a></li>
  <li><a href="#netxgraph" id="toc-netxgraph" class="nav-link" data-scroll-target="#netxgraph">NetxGraph</a></li>
  <li><a href="#netxstategraph" id="toc-netxstategraph" class="nav-link" data-scroll-target="#netxstategraph">NetxStateGraph</a></li>
  <li><a href="#dependencygraph" id="toc-dependencygraph" class="nav-link" data-scroll-target="#dependencygraph">DependencyGraph</a></li>
  <li><a href="#example-1" id="toc-example-1" class="nav-link" data-scroll-target="#example-1">Example</a></li>
  <li><a href="#termgraphbase" id="toc-termgraphbase" class="nav-link" data-scroll-target="#termgraphbase">TermGraphBase</a></li>
  <li><a href="#termgraphbase.add_rule_to_term_graph" id="toc-termgraphbase.add_rule_to_term_graph" class="nav-link" data-scroll-target="#termgraphbase.add_rule_to_term_graph">TermGraphBase.add_rule_to_term_graph</a></li>
  <li><a href="#termgraphbase.remove_rule" id="toc-termgraphbase.remove_rule" class="nav-link" data-scroll-target="#termgraphbase.remove_rule">TermGraphBase.remove_rule</a></li>
  <li><a href="#termgraphbase.add_rule_node" id="toc-termgraphbase.add_rule_node" class="nav-link" data-scroll-target="#termgraphbase.add_rule_node">TermGraphBase.add_rule_node</a></li>
  <li><a href="#termgraphbase._get_all_rules_with_head" id="toc-termgraphbase._get_all_rules_with_head" class="nav-link" data-scroll-target="#termgraphbase._get_all_rules_with_head">TermGraphBase._get_all_rules_with_head</a></li>
  <li><a href="#termgraphbase.remove_rules_with_head" id="toc-termgraphbase.remove_rules_with_head" class="nav-link" data-scroll-target="#termgraphbase.remove_rules_with_head">TermGraphBase.remove_rules_with_head</a></li>
  <li><a href="#termgraphbase.print_all_rules" id="toc-termgraphbase.print_all_rules" class="nav-link" data-scroll-target="#termgraphbase.print_all_rules">TermGraphBase.print_all_rules</a></li>
  <li><a href="#termgraphbase.get_mutually_recursive_relations" id="toc-termgraphbase.get_mutually_recursive_relations" class="nav-link" data-scroll-target="#termgraphbase.get_mutually_recursive_relations">TermGraphBase.get_mutually_recursive_relations</a></li>
  <li><a href="#termgraph" id="toc-termgraph" class="nav-link" data-scroll-target="#termgraph">TermGraph</a></li>
  <li><a href="#termgraph._compute_bounding_graph" id="toc-termgraph._compute_bounding_graph" class="nav-link" data-scroll-target="#termgraph._compute_bounding_graph">TermGraph._compute_bounding_graph</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/DeanLight/spannerlib/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">src</li><li class="breadcrumb-item"><a href="./ast_node_types.html">Graphs</a></li><li class="breadcrumb-item"><a href="./graphs.html">Graphs</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Graphs</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->
<p>This module contains the implementations of graphs (directed graphs).</p>
<p>The graphs we use when executing commands are called <code>term_graph</code>, <code>parse_graph</code>, and <code>dependency_graph</code>. the parse graph is an abstract syntax tree. it contains nodes which represent commands, like <a href="https://DeanLight.github.io/spannerlib/engine.html#add_fact"><code>add_fact</code></a>, <code>rule</code>, <a href="https://DeanLight.github.io/spannerlib/engine.html#query"><code>query</code></a>, etc. In order to compute rule nodes, or compute query nodes, we use the term graph.</p>
<p>The term graph is holding the connection between all the relations and rules in the program, for more description read <a href="https://DeanLight.github.io/spannerlib/graphs.html#termgraph"><code>TermGraph</code></a>’s documentation.</p>
<p>The dependency graph stores dependencies between relations in the program, it is used by the term graph to recognize mutually recursive relations. for more information read <a href="https://DeanLight.github.io/spannerlib/graphs.html#dependencygraph"><code>DependencyGraph</code></a>’s documentation.</p>
<hr>
<p><a href="https://github.com/DeanLight/spannerlib/blob/master/spannerlib/graphs.py#L32" target="_blank" style="float:right; font-size:smaller">source</a></p>
<section id="evalstate" class="level3">
<h3 class="anchored" data-anchor-id="evalstate">EvalState</h3>
<blockquote class="blockquote">
<pre><code> EvalState (value, names=None, module=None, qualname=None, type=None,
            start=1)</code></pre>
</blockquote>
<p><em>will be used to determine if a term is computed or not.</em></p>
<hr>
<p><a href="https://github.com/DeanLight/spannerlib/blob/master/spannerlib/graphs.py#L45" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="termnodetype" class="level3">
<h3 class="anchored" data-anchor-id="termnodetype">TermNodeType</h3>
<blockquote class="blockquote">
<pre><code> TermNodeType (value, names=None, module=None, qualname=None, type=None,
               start=1)</code></pre>
</blockquote>
<p><em>will be used to represent type of term graph nodes.</em></p>
<hr>
<p><a href="https://github.com/DeanLight/spannerlib/blob/master/spannerlib/graphs.py#L65" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="graphbase" class="level3">
<h3 class="anchored" data-anchor-id="graphbase">GraphBase</h3>
<blockquote class="blockquote">
<pre><code> GraphBase ()</code></pre>
</blockquote>
<p><em>This is an interface for a simple graph.</em></p>
<hr>
<p><a href="https://github.com/DeanLight/spannerlib/blob/master/spannerlib/graphs.py#L74" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="graphbase.add_node" class="level3">
<h3 class="anchored" data-anchor-id="graphbase.add_node">GraphBase.add_node</h3>
<blockquote class="blockquote">
<pre><code> GraphBase.add_node (node_id:Union[int,str,NoneType]=None, **attr:Dict)</code></pre>
</blockquote>
<p><em>Adds a node to the graph.</em></p>
<table class="table">
<colgroup>
<col style="width: 6%">
<col style="width: 25%">
<col style="width: 34%">
<col style="width: 34%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>node_id</td>
<td>Optional[NodeIdType]</td>
<td>None</td>
<td>the id of the node (optional)</td>
</tr>
<tr class="even">
<td>attr</td>
<td>Dict</td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td><strong>Returns</strong></td>
<td><strong>NodeIdType</strong></td>
<td></td>
<td><strong>a node id that refers to the node that was added</strong></td>
</tr>
</tbody>
</table>
<hr>
<p><a href="https://github.com/DeanLight/spannerlib/blob/master/spannerlib/graphs.py#L84" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="graphbase.get_root_id" class="level3">
<h3 class="anchored" data-anchor-id="graphbase.get_root_id">GraphBase.get_root_id</h3>
<blockquote class="blockquote">
<pre><code> GraphBase.get_root_id ()</code></pre>
</blockquote>
<p><em><span class="citation" data-cites="return">@return</span>: the node id of the root of the graph.</em></p>
<hr>
<p><a href="https://github.com/DeanLight/spannerlib/blob/master/spannerlib/graphs.py#L91" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="graphbase.remove_node" class="level3">
<h3 class="anchored" data-anchor-id="graphbase.remove_node">GraphBase.remove_node</h3>
<blockquote class="blockquote">
<pre><code> GraphBase.remove_node (node_id:Union[int,str])</code></pre>
</blockquote>
<p><em>Removes a node from the graph.</em></p>
<table class="table">
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>node_id</td>
<td>NodeIdType</td>
<td>the id of the node that will be removed</td>
</tr>
<tr class="even">
<td><strong>Returns</strong></td>
<td><strong>None</strong></td>
<td></td>
</tr>
</tbody>
</table>
<hr>
<p><a href="https://github.com/DeanLight/spannerlib/blob/master/spannerlib/graphs.py#L100" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="graphbase.add_edge" class="level3">
<h3 class="anchored" data-anchor-id="graphbase.add_edge">GraphBase.add_edge</h3>
<blockquote class="blockquote">
<pre><code> GraphBase.add_edge (father_id:Union[int,str], son_id:Union[int,str],
                     **attr:Dict)</code></pre>
</blockquote>
<p><em>Adds the edge (<code>father_id</code>, <code>son_id</code>) to the graph. <br> the edge signifies that the father node is dependent on the son node.</em></p>
<table class="table">
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>father_id</td>
<td>NodeIdType</td>
<td>the id of the father node</td>
</tr>
<tr class="even">
<td>son_id</td>
<td>NodeIdType</td>
<td>the id of the son node</td>
</tr>
<tr class="odd">
<td>attr</td>
<td>Dict</td>
<td></td>
</tr>
<tr class="even">
<td><strong>Returns</strong></td>
<td><strong>None</strong></td>
<td><strong>the attributes for the edge</strong></td>
</tr>
</tbody>
</table>
<hr>
<p><a href="https://github.com/DeanLight/spannerlib/blob/master/spannerlib/graphs.py#L112" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="graphbase.pre_order_dfs_from" class="level3">
<h3 class="anchored" data-anchor-id="graphbase.pre_order_dfs_from">GraphBase.pre_order_dfs_from</h3>
<blockquote class="blockquote">
<pre><code> GraphBase.pre_order_dfs_from (node_id:Union[int,str])</code></pre>
</blockquote>
<table class="table">
<colgroup>
<col style="width: 9%">
<col style="width: 38%">
<col style="width: 52%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>node_id</td>
<td>NodeIdType</td>
<td>the id of the node we will start the pre_order dfs from</td>
</tr>
<tr class="even">
<td><strong>Returns</strong></td>
<td><strong>Iterable[NodeIdType]</strong></td>
<td><strong>an iterable of the node ids generated from a depth-first-search pre-ordering starting at the root of the graph</strong></td>
</tr>
</tbody>
</table>
<hr>
<p><a href="https://github.com/DeanLight/spannerlib/blob/master/spannerlib/graphs.py#L117" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="graphbase.pre_order_dfs" class="level3">
<h3 class="anchored" data-anchor-id="graphbase.pre_order_dfs">GraphBase.pre_order_dfs</h3>
<blockquote class="blockquote">
<pre><code> GraphBase.pre_order_dfs ()</code></pre>
</blockquote>
<p><em><span class="citation" data-cites="return">@return</span>: an iterable of the node ids generated from a depth-first-search pre-ordering starting at the root of the graph.</em></p>
<hr>
<p><a href="https://github.com/DeanLight/spannerlib/blob/master/spannerlib/graphs.py#L125" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="graphbase.post_order_dfs_from" class="level3">
<h3 class="anchored" data-anchor-id="graphbase.post_order_dfs_from">GraphBase.post_order_dfs_from</h3>
<blockquote class="blockquote">
<pre><code> GraphBase.post_order_dfs_from (node_id:Union[int,str])</code></pre>
</blockquote>
<table class="table">
<colgroup>
<col style="width: 9%">
<col style="width: 38%">
<col style="width: 52%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>node_id</td>
<td>NodeIdType</td>
<td>the id of the node we will run post_order dfs to</td>
</tr>
<tr class="even">
<td><strong>Returns</strong></td>
<td><strong>Iterable[NodeIdType]</strong></td>
<td><strong>an iterable of the node ids generated from a depth-first-search post-ordering starting at the root of the graph.</strong></td>
</tr>
</tbody>
</table>
<hr>
<p><a href="https://github.com/DeanLight/spannerlib/blob/master/spannerlib/graphs.py#L130" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="graphbase.post_order_dfs" class="level3">
<h3 class="anchored" data-anchor-id="graphbase.post_order_dfs">GraphBase.post_order_dfs</h3>
<blockquote class="blockquote">
<pre><code> GraphBase.post_order_dfs ()</code></pre>
</blockquote>
<p><em><span class="citation" data-cites="return">@return</span>: an iterable of the node ids generated from a depth-first-search post-ordering starting at the root of the graph.</em></p>
<hr>
<p><a href="https://github.com/DeanLight/spannerlib/blob/master/spannerlib/graphs.py#L138" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="graphbase.get_children" class="level3">
<h3 class="anchored" data-anchor-id="graphbase.get_children">GraphBase.get_children</h3>
<blockquote class="blockquote">
<pre><code> GraphBase.get_children (node_id:Union[int,str])</code></pre>
</blockquote>
<p><em>In a term graph the children of a node are its dependencies this function returns the children of a node.</em></p>
<table class="table">
<colgroup>
<col style="width: 9%">
<col style="width: 38%">
<col style="width: 52%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>node_id</td>
<td>NodeIdType</td>
<td>the id of the node that we wish to get its children</td>
</tr>
<tr class="even">
<td><strong>Returns</strong></td>
<td><strong>Iterable[NodeIdType]</strong></td>
<td><strong>an iterable of the children of the node</strong></td>
</tr>
</tbody>
</table>
<hr>
<p><a href="https://github.com/DeanLight/spannerlib/blob/master/spannerlib/graphs.py#L147" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="graphbase.get_child" class="level3">
<h3 class="anchored" data-anchor-id="graphbase.get_child">GraphBase.get_child</h3>
<blockquote class="blockquote">
<pre><code> GraphBase.get_child (node_id:Union[int,str])</code></pre>
</blockquote>
<p><em><span class="citation" data-cites="raise">@raise</span>: RuntimeError if <code>node_id</code> has more than one child</em></p>
<table class="table">
<colgroup>
<col style="width: 9%">
<col style="width: 38%">
<col style="width: 52%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>node_id</td>
<td>NodeIdType</td>
<td>the id of the node that we wish to get its child</td>
</tr>
<tr class="even">
<td><strong>Returns</strong></td>
<td><strong>NodeIdType</strong></td>
<td><strong>the child of the node</strong></td>
</tr>
</tbody>
</table>
<hr>
<p><a href="https://github.com/DeanLight/spannerlib/blob/master/spannerlib/graphs.py#L160" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="graphbase.get_parents" class="level3">
<h3 class="anchored" data-anchor-id="graphbase.get_parents">GraphBase.get_parents</h3>
<blockquote class="blockquote">
<pre><code> GraphBase.get_parents (node_id:Union[int,str])</code></pre>
</blockquote>
<table class="table">
<colgroup>
<col style="width: 9%">
<col style="width: 38%">
<col style="width: 52%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>node_id</td>
<td>NodeIdType</td>
<td>the id of the node that we wish to get its predecessors</td>
</tr>
<tr class="even">
<td><strong>Returns</strong></td>
<td><strong>Iterable[NodeIdType]</strong></td>
<td><strong>the parents (predecessors) of the node</strong></td>
</tr>
</tbody>
</table>
<hr>
<p><a href="https://github.com/DeanLight/spannerlib/blob/master/spannerlib/graphs.py#L165" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="graphbase.get_parent" class="level3">
<h3 class="anchored" data-anchor-id="graphbase.get_parent">GraphBase.get_parent</h3>
<blockquote class="blockquote">
<pre><code> GraphBase.get_parent (node_id:Union[int,str])</code></pre>
</blockquote>
<p><em><span class="citation" data-cites="raise">@raise</span>: RuntimeError if <code>node_id</code> has more than one parent</em></p>
<table class="table">
<colgroup>
<col style="width: 9%">
<col style="width: 38%">
<col style="width: 52%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>node_id</td>
<td>NodeIdType</td>
<td>the id of the node that we wish to get its predecessor</td>
</tr>
<tr class="even">
<td><strong>Returns</strong></td>
<td><strong>NodeIdType</strong></td>
<td><strong>the parent of the node</strong></td>
</tr>
</tbody>
</table>
<hr>
<p><a href="https://github.com/DeanLight/spannerlib/blob/master/spannerlib/graphs.py#L178" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="graphbase.is_contains_node" class="level3">
<h3 class="anchored" data-anchor-id="graphbase.is_contains_node">GraphBase.is_contains_node</h3>
<blockquote class="blockquote">
<pre><code> GraphBase.is_contains_node (node_id:Union[int,str])</code></pre>
</blockquote>
<p><em>Checks if node is in the graph.</em></p>
<table class="table">
<colgroup>
<col style="width: 9%">
<col style="width: 38%">
<col style="width: 52%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>node_id</td>
<td>NodeIdType</td>
<td>the node to look for</td>
</tr>
<tr class="even">
<td><strong>Returns</strong></td>
<td><strong>bool</strong></td>
<td><strong>True if node is in the graph, False otherwise</strong></td>
</tr>
</tbody>
</table>
<hr>
<p><a href="https://github.com/DeanLight/spannerlib/blob/master/spannerlib/graphs.py#L187" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="graphbase.set_node_attribute" class="level3">
<h3 class="anchored" data-anchor-id="graphbase.set_node_attribute">GraphBase.set_node_attribute</h3>
<blockquote class="blockquote">
<pre><code> GraphBase.set_node_attribute (node_id:Union[int,str], attr_name:str,
                               attr_value:Any)</code></pre>
</blockquote>
<p><em>Sets an attribute of a node.</em></p>
<table class="table">
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>node_id</td>
<td>NodeIdType</td>
<td>the id of the node</td>
</tr>
<tr class="even">
<td>attr_name</td>
<td>str</td>
<td>the name of the attribute</td>
</tr>
<tr class="odd">
<td>attr_value</td>
<td>Any</td>
<td>the value that will be set for the attribute</td>
</tr>
<tr class="even">
<td><strong>Returns</strong></td>
<td><strong>None</strong></td>
<td></td>
</tr>
</tbody>
</table>
<hr>
<p><a href="https://github.com/DeanLight/spannerlib/blob/master/spannerlib/graphs.py#L198" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="graphbase.get_node_attributes" class="level3">
<h3 class="anchored" data-anchor-id="graphbase.get_node_attributes">GraphBase.get_node_attributes</h3>
<blockquote class="blockquote">
<pre><code> GraphBase.get_node_attributes (node_id:Union[int,str])</code></pre>
</blockquote>
<table class="table">
<colgroup>
<col style="width: 9%">
<col style="width: 38%">
<col style="width: 52%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>node_id</td>
<td>NodeIdType</td>
<td>the id of the node we wish to get its attributes</td>
</tr>
<tr class="even">
<td><strong>Returns</strong></td>
<td><strong>Dict[str, Any]</strong></td>
<td><strong>a dict containing the attributes of the node</strong></td>
</tr>
</tbody>
</table>
<hr>
<p><a href="https://github.com/DeanLight/spannerlib/blob/master/spannerlib/graphs.py#L213" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="graphbase.get_all_nodes_with_attributes" class="level3">
<h3 class="anchored" data-anchor-id="graphbase.get_all_nodes_with_attributes">GraphBase.get_all_nodes_with_attributes</h3>
<blockquote class="blockquote">
<pre><code> GraphBase.get_all_nodes_with_attributes
                                          (sub_graph_root:Union[int,str,No
                                          neType]=None, **attributes:Any)</code></pre>
</blockquote>
<table class="table">
<colgroup>
<col style="width: 6%">
<col style="width: 25%">
<col style="width: 34%">
<col style="width: 34%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>sub_graph_root</td>
<td>Optional[NodeIdType]</td>
<td>None</td>
<td>the sub-graph root. if set to None then we search in the entire graph</td>
</tr>
<tr class="even">
<td>attributes</td>
<td>Any</td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td><strong>Returns</strong></td>
<td><strong>Iterable[NodeIdType]</strong></td>
<td></td>
<td><strong>all nodes that contains all the attributes inside the sub-graph</strong></td>
</tr>
</tbody>
</table>
<hr>
<p><a href="https://github.com/DeanLight/spannerlib/blob/master/spannerlib/graphs.py#L273" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="netxgraph" class="level3">
<h3 class="anchored" data-anchor-id="netxgraph">NetxGraph</h3>
<blockquote class="blockquote">
<pre><code> NetxGraph ()</code></pre>
</blockquote>
<p><em>Implementation of a graph using a NetworkX graph. <br> The official documentation for NetworkX can be found here: <a href="https://networkx.org/documentation/stable/index.html">NetworkX Documentation</a>. <br> For a basic tutorial on NetworkX, you can visit: <a href="https://networkx.org/documentation/stable//reference/introduction.html">NetworkX Introduction</a>.</em></p>
<hr>
<p><a href="https://github.com/DeanLight/spannerlib/blob/master/spannerlib/graphs.py#L358" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="netxstategraph" class="level3">
<h3 class="anchored" data-anchor-id="netxstategraph">NetxStateGraph</h3>
<blockquote class="blockquote">
<pre><code> NetxStateGraph ()</code></pre>
</blockquote>
<p><em>This is a wrapper to NetxGraph that stores a state and type for each node in the graph. (This class will be the base class of the term graph and the parse graph while NetxGraph will be the base of dependency graph).</em></p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Example
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div id="cell-25" class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>graph <span class="op">=</span> NetxStateGraph()</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>node0 <span class="op">=</span> graph.add_node(<span class="bu">type</span><span class="op">=</span><span class="st">"int"</span>)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>node1 <span class="op">=</span> graph.add_node(<span class="bu">type</span><span class="op">=</span><span class="st">"string"</span>)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>node2 <span class="op">=</span> graph.add_node(<span class="bu">type</span><span class="op">=</span><span class="st">"float"</span>)</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>graph.add_edge(node0,node1)</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>graph.add_edge(node0,node2)</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(graph._get_node_string(node0))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(0) (not_computed) int</code></pre>
</div>
</div>
<div id="cell-26" class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(graph.get_children(node0))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1, 2]</code></pre>
</div>
</div>
</div>
</div>
</div>
<hr>
<p><a href="https://github.com/DeanLight/spannerlib/blob/master/spannerlib/graphs.py#L406" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="dependencygraph" class="level3">
<h3 class="anchored" data-anchor-id="dependencygraph">DependencyGraph</h3>
<blockquote class="blockquote">
<pre><code> DependencyGraph ()</code></pre>
</blockquote>
<p>*The <a href="https://DeanLight.github.io/spannerlib/graphs.html#dependencygraph"><code>DependencyGraph</code></a> class is designed to map and manage dependencies between rule relations in an spannerlog program. Each rule relation in the program corresponds to a node in this graph, with the node’s ID being the name of the rule relation.</p>
</section>
<section id="example-1" class="level3">
<h3 class="anchored" data-anchor-id="example-1">Example</h3>
<p>Consider the following spannerlog program:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode prolog code-with-copy"><code class="sourceCode prolog"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>new <span class="dt">A</span>(int)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="dt">B</span>(<span class="dt">X</span>) &lt;- <span class="dt">A</span>(<span class="dt">X</span>)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="dt">C</span>(<span class="dt">X</span>) &lt;- <span class="dt">A</span>(<span class="dt">X</span>)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="dt">B</span>(<span class="dt">X</span>) &lt;- <span class="dt">C</span>(<span class="dt">X</span>)  # <span class="dt">B</span> <span class="dt">is</span> dependent on <span class="dt">C</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="dt">C</span>(<span class="dt">X</span>) &lt;- <span class="dt">B</span>(<span class="dt">X</span>)  # <span class="dt">C</span> <span class="dt">is</span> dependent on <span class="dt">B</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="dt">D</span>(<span class="dt">X</span>) &lt;- <span class="dt">C</span>(<span class="dt">X</span>)  # <span class="dt">D</span> <span class="dt">is</span> dependent on <span class="dt">C</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>In this case the dependency graph will be: <br> <strong>Nodes</strong> = {A, B, C, D} (all the rule relations) <br> <strong>Edges</strong> = {(B, C), (C, B), (D, C)}*</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Main utility
</div>
</div>
<div class="callout-body-container callout-body">
<p>In order to find mutually recursive rule relations we just need to compute the strongly connected components of the graph (all the relations in a certain component are mutually recursive).</p>
</div>
</div>
<hr>
<p><a href="https://github.com/DeanLight/spannerlib/blob/master/spannerlib/graphs.py#L547" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="termgraphbase" class="level3">
<h3 class="anchored" data-anchor-id="termgraphbase">TermGraphBase</h3>
<blockquote class="blockquote">
<pre><code> TermGraphBase ()</code></pre>
</blockquote>
<p><em>A wrapper to <a href="https://DeanLight.github.io/spannerlib/graphs.html#netxstategraph"><code>NetxStateGraph</code></a> that adds utility functions which are independent of the structure of the term graph.</em></p>
<hr>
<p><a href="https://github.com/DeanLight/spannerlib/blob/master/spannerlib/graphs.py#L560" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="termgraphbase.add_rule_to_term_graph" class="level3">
<h3 class="anchored" data-anchor-id="termgraphbase.add_rule_to_term_graph">TermGraphBase.add_rule_to_term_graph</h3>
<blockquote class="blockquote">
<pre><code> TermGraphBase.add_rule_to_term_graph
                                       (rule:spannerlib.ast_node_types.Rul
                                       e)</code></pre>
</blockquote>
<p><em>Adds the rule to the term graph. This function is responsible for the structure of the term graph.</em></p>
<table class="table">
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>rule</td>
<td>Rule</td>
<td>the rule to add.</td>
</tr>
<tr class="even">
<td><strong>Returns</strong></td>
<td><strong>None</strong></td>
<td></td>
</tr>
</tbody>
</table>
<hr>
<p><a href="https://github.com/DeanLight/spannerlib/blob/master/spannerlib/graphs.py#L570" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="termgraphbase.remove_rule" class="level3">
<h3 class="anchored" data-anchor-id="termgraphbase.remove_rule">TermGraphBase.remove_rule</h3>
<blockquote class="blockquote">
<pre><code> TermGraphBase.remove_rule (rule:str)</code></pre>
</blockquote>
<p><em>Removes rule from the term graph. This function depends on the structure of the term graph.</em></p>
<table class="table">
<colgroup>
<col style="width: 9%">
<col style="width: 38%">
<col style="width: 52%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>rule</td>
<td>str</td>
<td>the rule to remove</td>
</tr>
<tr class="even">
<td><strong>Returns</strong></td>
<td><strong>bool</strong></td>
<td><strong>Whether the deletion of the rule succeeded</strong></td>
</tr>
</tbody>
</table>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The rule is in string format and must be exactly equal the the original rule (i.e., if you want to delete the rule A(X) &lt;-B(X), you must pass A(X) &lt;- B(X) and not A(Y) &lt;- B(Y))</p>
</div>
</div>
<hr>
<p><a href="https://github.com/DeanLight/spannerlib/blob/master/spannerlib/graphs.py#L579" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="termgraphbase.add_rule_node" class="level3">
<h3 class="anchored" data-anchor-id="termgraphbase.add_rule_node">TermGraphBase.add_rule_node</h3>
<blockquote class="blockquote">
<pre><code> TermGraphBase.add_rule_node (rule:spannerlib.ast_node_types.Rule,
                              nodes:Set[str])</code></pre>
</blockquote>
<p><em>Adds rule to term graph dict.</em></p>
<table class="table">
<colgroup>
<col style="width: 9%">
<col style="width: 38%">
<col style="width: 52%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>rule</td>
<td>Rule</td>
<td>The rule to add</td>
</tr>
<tr class="even">
<td>nodes</td>
<td>Set[str]</td>
<td>(and thus should be removed if the rule is removed)</td>
</tr>
<tr class="odd">
<td><strong>Returns</strong></td>
<td><strong>None</strong></td>
<td></td>
</tr>
</tbody>
</table>
<hr>
<p><a href="https://github.com/DeanLight/spannerlib/blob/master/spannerlib/graphs.py#L589" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="termgraphbase._get_all_rules_with_head" class="level3">
<h3 class="anchored" data-anchor-id="termgraphbase._get_all_rules_with_head">TermGraphBase._get_all_rules_with_head</h3>
<blockquote class="blockquote">
<pre><code> TermGraphBase._get_all_rules_with_head (relation_name:str)</code></pre>
</blockquote>
<p><em>Find all the rule with rule head. <span class="citation" data-cites="raise">@raise</span> ValueError: if relation name doesn’t exist in the graph.</em></p>
<table class="table">
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>relation_name</td>
<td>str</td>
<td>name of the relation</td>
</tr>
<tr class="even">
<td><strong>Returns</strong></td>
<td><strong>List[str]</strong></td>
<td><strong>a list of rules with rule head</strong></td>
</tr>
</tbody>
</table>
<hr>
<p><a href="https://github.com/DeanLight/spannerlib/blob/master/spannerlib/graphs.py#L605" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="termgraphbase.remove_rules_with_head" class="level3">
<h3 class="anchored" data-anchor-id="termgraphbase.remove_rules_with_head">TermGraphBase.remove_rules_with_head</h3>
<blockquote class="blockquote">
<pre><code> TermGraphBase.remove_rules_with_head (rule_head_name:str)</code></pre>
</blockquote>
<p><em>Removes all rules with given rule head from the term graph. <br> <span class="citation" data-cites="raise">@raise</span> ValueError: if the <code>rule_head_name</code> is being used by another rule</em></p>
<table class="table">
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>rule_head_name</td>
<td>str</td>
<td>a relation name</td>
</tr>
<tr class="even">
<td><strong>Returns</strong></td>
<td><strong>None</strong></td>
<td></td>
</tr>
</tbody>
</table>
<hr>
<p><a href="https://github.com/DeanLight/spannerlib/blob/master/spannerlib/graphs.py#L621" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="termgraphbase.print_all_rules" class="level3">
<h3 class="anchored" data-anchor-id="termgraphbase.print_all_rules">TermGraphBase.print_all_rules</h3>
<blockquote class="blockquote">
<pre><code> TermGraphBase.print_all_rules (head:Union[str,NoneType])</code></pre>
</blockquote>
<p><em>Prints all the registered rules.</em></p>
<table class="table">
<colgroup>
<col style="width: 9%">
<col style="width: 38%">
<col style="width: 52%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>head</td>
<td>Optional[str]</td>
<td>If you want to print all the rules with a specific head</td>
</tr>
<tr class="even">
<td><strong>Returns</strong></td>
<td><strong>None</strong></td>
<td></td>
</tr>
</tbody>
</table>
<hr>
<p><a href="https://github.com/DeanLight/spannerlib/blob/master/spannerlib/graphs.py#L639" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="termgraphbase.get_mutually_recursive_relations" class="level3">
<h3 class="anchored" data-anchor-id="termgraphbase.get_mutually_recursive_relations">TermGraphBase.get_mutually_recursive_relations</h3>
<blockquote class="blockquote">
<pre><code> TermGraphBase.get_mutually_recursive_relations (relation_name:str)</code></pre>
</blockquote>
<p><em>See documentation of <code>get_mutually_recursive_relations</code> in <a href="https://DeanLight.github.io/spannerlib/graphs.html#dependencygraph"><code>DependencyGraph</code></a></em></p>
<table class="table">
<colgroup>
<col style="width: 9%">
<col style="width: 38%">
<col style="width: 52%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>relation_name</td>
<td>str</td>
<td>relation name that you want to get its mutually recursive relations</td>
</tr>
<tr class="even">
<td><strong>Returns</strong></td>
<td><strong>Set[str]</strong></td>
<td><strong>A set of mutually recursive relations with the given relation name</strong></td>
</tr>
</tbody>
</table>
<hr>
<p><a href="https://github.com/DeanLight/spannerlib/blob/master/spannerlib/graphs.py#L652" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="termgraph" class="level3">
<h3 class="anchored" data-anchor-id="termgraph">TermGraph</h3>
<blockquote class="blockquote">
<pre><code> TermGraph ()</code></pre>
</blockquote>
<p>*This class is designed to transform each rule node in an spannerlog program into an execution graph. These execution graphs are then added to a term graph. <br></p>
<p>The term graph serves to store relationships between the following entities: <br> 1. <strong>The Rule Head</strong>: The leading variable or fact in a rule. <br> 2. <strong>The Body Rule Relations</strong>: The components that make up the conditions of the rule. <br> 3. <strong>The Body Base Relations and IE Relations</strong>: Relations that are intrinsic or part of external functions. <br> 4. <strong>Computation Paths of The Rule Head</strong>: All possible paths that lead to the evaluation of the rule head.</p>
<p>Here is a sample spannerlog program for illustration:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode prolog code-with-copy"><code class="sourceCode prolog"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>new <span class="dt">A</span>(int<span class="kw">,</span> int)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>new <span class="dt">B</span>(int<span class="kw">,</span> int)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="dt">C</span>(<span class="dt">X</span><span class="kw">,</span> <span class="dt">Y</span>) &lt;- <span class="dt">A</span>(<span class="dt">X</span><span class="kw">,</span> <span class="dt">Y</span>)</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="dt">D</span>(<span class="dt">X</span><span class="kw">,</span> <span class="dt">Y</span>) &lt;- <span class="dt">C</span>(<span class="dt">X</span><span class="kw">,</span> <span class="dt">Y</span>)</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="dt">D</span>(<span class="dt">X</span><span class="kw">,</span> <span class="dt">Y</span>) &lt;- <span class="dt">A</span>(<span class="dt">X</span><span class="kw">,</span> <span class="dv">1</span>)<span class="kw">,</span> <span class="dt">B</span>(<span class="dt">X</span><span class="kw">,</span> <span class="dt">Y</span>)<span class="kw">,</span> <span class="dt">ID</span>(<span class="dt">X</span>) <span class="kw">-&gt;</span> (<span class="dt">Y</span>)  # <span class="dt">ID</span> <span class="dt">is</span> some ie function</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>We will explain the meaning of the four core entities in the term graph with respect to the rules of <code>D</code></p>
<ol type="1">
<li><strong>Rule Head</strong>: The rule head for these rules is <code>D(X, Y)</code>.</li>
<li><strong>Body Rule Relations</strong>: The body relations for the first rule is <code>C(X, Y)</code>. The second rule has no body rule relations.</li>
<li><strong>Base Relations</strong>: The base relations for the second rule are <code>A(X, 1)</code> and <code>B(X, Y)</code>. The first rule has no base relations.</li>
<li><strong>Computation Paths</strong>: The computation paths consist of paths from both the first and second rule.</li>
</ol>
<p><strong>Term Graph Structure</strong></p>
<p>Nodes:</p>
<ul>
<li><p><strong><code>rule_rel Node</code></strong>: Each rule relation has a corresponding node in the term graph. Every <code>rule_rel node</code> is connected to a global root.</p></li>
<li><p><strong><code>union_node</code></strong>: Each <code>rule_rel node</code> connects to a <code>union_node</code>.</p></li>
<li><p><strong><code>project_node</code></strong>: Starts each computation path, projecting the columns of the relation it receives. It is connected to the <code>union_node</code>.</p></li>
<li><p><strong><code>join_node</code></strong>: This node is under the <code>project_node</code> and joins all the body relations of the rule. Special cases where this node isn’t used include:</p>
<ul>
<li>There’s only one relation in the rule’s body.</li>
<li>None of the body relations have free variables.</li>
</ul></li>
<li><p><strong><code>calc_node</code></strong>: Connects each IE relation in the rule’s body to the <code>join_node</code>. This node itself connects to another <code>join_node</code> that links all the bounding relations of the IE relation.</p></li>
<li><p><strong><code>get_rel node</code></strong>: Connects each rule relation in the rule’s body to the <code>join_node</code>. This node is linked to the corresponding rule root.</p></li>
<li><p><strong><code>select_node</code></strong>: Used for relations with the same free variable (e.g., <code>A(X, X)</code>) or relations with some constant value (e.g., <code>A(1, X)</code>). This node deals with filtering tuples and is connected to the <code>join_node</code>.</p></li>
<li><p><strong>Base Relations</strong>: Each base relation is directly connected to the <code>join_node</code>.</p></li>
</ul>
<p>Here’s a representation of the term graph for the spannerlog program discussed:</p>
<pre><code>global root

   rule_rel node (of C)
       union node
           project node
               get_rel node (get A)  @note: there isn't join node since there is only one body relation.

   rule_rel node (of D)
       union node
           project node
               get_rel node (get C)  @note: there isn't join node since there is only one body relation.
                   rule_rel node (of C)

           project node
               join node (join A, B and ID)
                   get_rel node (get B)
                   select_node (select from A)
                       get_rel node (get A)
                   calc node (of ID)
                       join node (join A and B)
                           get_rel node (get B)         @note: this get_rel node is the same one from above.
                           select_node (select from A)  @note: this select node is the same one from above.
                               get_rel node (get A)*</code></pre>
<hr>
<p><a href="https://github.com/DeanLight/spannerlib/blob/master/spannerlib/graphs.py#L726" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="termgraph._compute_bounding_graph" class="level3">
<h3 class="anchored" data-anchor-id="termgraph._compute_bounding_graph">TermGraph._compute_bounding_graph</h3>
<blockquote class="blockquote">
<pre><code> TermGraph._compute_bounding_graph
                                    (relations:Set[spannerlib.ast_node_typ
                                    es.Relation], ie_relations:Set[spanner
                                    lib.ast_node_types.IERelation])</code></pre>
</blockquote>
<p><em>This function gets body relations of a rule and computes for each ie relation the relations that bound it.</em></p>
<table class="table">
<colgroup>
<col style="width: 9%">
<col style="width: 38%">
<col style="width: 52%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>relations</td>
<td>Set[Relation]</td>
<td>set of the regular relations in the rule body</td>
</tr>
<tr class="even">
<td>ie_relations</td>
<td>Set[IERelation]</td>
<td>set of the ie relations in the rule body</td>
</tr>
<tr class="odd">
<td><strong>Returns</strong></td>
<td><strong>OrderedDictType[IERelation, Set[Union[Relation, IERelation]]]</strong></td>
<td><strong>a dictionary that maps each ie function to a set of it’s bounding relations</strong></td>
</tr>
</tbody>
</table>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>In some cases ie relation is bounded by other ie relation. e.g.&nbsp;A(X) &lt;- B(Y), C(Z) -&gt; (X), D(Y) -&gt; (Z); in this example C is bounded only by D.</p>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/DeanLight\.github\.io\/spannerlib");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/DeanLight/spannerlib/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></div></div></footer></body></html>